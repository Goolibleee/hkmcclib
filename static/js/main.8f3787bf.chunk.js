(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[0],{149:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOut":"Check Out","bookSearch":"Book Search","userSearch":"User Search","return":"Return","history":"Rent History","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Overdue","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","noEntry":"No entry","notice":"Notice","autoLogin":"AutoLogin","userMode":"User Mode","adminMode":"Admin Mode","normal":"Normal","stopped":"Stopped","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOutStatus":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","bookSearch":"\ub3c4\uc11c \uac80\uc0c9","userSearch":"\ud68c\uc6d0 \uac80\uc0c9","checkOut":"\ub300\ucd9c","return":"\ubc18\ub0a9","history":"\ub300\ucd9c \uc774\ub825","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0 \uc0ac\ud56d","autoLogin":"\uc790\ub3d9 \ub85c\uadf8\uc778","userMode":"\uc77c\ubc18 \ubaa8\ub4dc","adminMode":"\uad00\ub9ac\uc790 \ubaa8\ub4dc","normal":"\uc815\uc0c1","stopped":"\ub300\ucd9c\uc911\uc9c0","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>"}}')},216:function(e){e.exports=JSON.parse('{"privateKey":"-----BEGIN RSA PRIVATE KEY-----\\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\\n-----END RSA PRIVATE KEY-----\\n"}')},236:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},243:function(e,t,n){},251:function(e,t){},254:function(e,t){},265:function(e,t){},267:function(e,t){},294:function(e,t){},296:function(e,t){},297:function(e,t){},302:function(e,t){},304:function(e,t){},310:function(e,t){},312:function(e,t){},331:function(e,t){},343:function(e,t){},346:function(e,t){},368:function(e,t,n){},369:function(e,t,n){},371:function(e,t,n){"use strict";n.r(t);var c=n(3),o=n(9),r=n(0),a=n.n(r),i=n(101),s=n.n(i),l=(n(236),n(6)),d=(n(237),n(20)),u=(n(238),10),b=500;String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var h={position:"bottom-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},j="custom-loading-id",O="custom-logging-id",f=n(1);var g,p,x,v,m,k,y,S,C=function(e){function t(){return n.apply(this,arguments)}function n(){return n=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(r.length>0&&void 0!==r[0])||r[0],console.log("All data loaded "),n&&((o=h).type=d.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",d.c.info(e.text.succeededToOpen,o)),console.log("Done");case 4:case"end":return t.stop()}}),t)}))),n.apply(this,arguments)}return Object(r.useEffect)((function(){function n(){return(n=Object(o.a)(Object(c.a)().mark((function n(){return Object(c.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("Home"),e.doc.isOpen()?t(!1):e.doc.setCallback(t);case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[]),Object(f.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},w=(n(94),n(222)),I=n(386),E=n(109),D=n.n(E),N=n(110),_=n.n(N),L=n(54),R=n(55),T=Object(R.a)(g||(g=Object(L.a)(["\n    query AllBook{\n        books (sortBy: TITLE_ASC, limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n        }\n    }\n"]))),A=Object(R.a)(p||(p=Object(L.a)(["\n    query AllRent{\n        rents (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            state\n        }\n    }\n"]))),U=Object(R.a)(x||(x=Object(L.a)(["\n    query AllUser {\n        users (limit: 20000) {\n            _id\n            name\n            state\n            level\n        }\n    }"]))),P=Object(R.a)(v||(v=Object(L.a)(["\n    query FindUser($_id: String!){\n        user (query: {_id:$_id}) {\n            _id\n            name\n            state\n            level\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),M=Object(R.a)(m||(m=Object(L.a)(["\n    query findLogs($user_id: String!){\n        rentLogs (query: {user_id: $user_id}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            user_id\n        }\n    }"]))),B=Object(R.a)(k||(k=Object(L.a)(["\n    query GetNotices {\n        notices (sortBy: _ID_DESC, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),H=Object(R.a)(y||(y=Object(L.a)(["\n    query GetContent ($_id: String!) {\n        notice (query: {_id: $_id}) {\n            _id\n            date\n            title\n            content\n        }\n    }"]))),F=Object(R.a)(S||(S=Object(L.a)(["\n    query GetServerInfo {\n        serverInfo {\n            _id\n            globalIp\n            localIp\n            port\n        }\n    }"])));var q=function(e){var t=Object(r.useState)([]),n=Object(l.a)(t,2),a=n[0],i=n[1],s=Object(r.useState)([]),b=Object(l.a)(s,2),j=b[0],O=b[1],g=Object(r.useState)(0),p=Object(l.a)(g,2),x=p[0],v=p[1],m=Object(r.useState)(-1),k=Object(l.a)(m,2),y=k[0],S=k[1],C=Object(w.b)(B),E=C.loading,N=C.data,L=C.error,R=Object(I.a)(H,{variables:{_id:y}}),T=Object(l.a)(R,2),A=T[0],U=T[1],P=U.loading,M=U.data,F=U.error;function q(){return z.apply(this,arguments)}function z(){return z=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(r.length>0&&void 0!==r[0])||r[0],console.log("All data loaded "),n&&((o=h).type=d.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",d.c.info(e.text.succeededToOpen,o)),console.log("Done");case 4:case"end":return t.stop()}}),t)}))),z.apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Notice"),e.doc.isOpen()?q(!1):e.doc.setCallback(q);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Get Notice"),N&&i(N.notices)}),[N,L,E]),Object(r.useEffect)((function(){console.log("Get Content")}),[M,F,P]),Object(r.useEffect)((function(){var e=a.length;if(console.log("Page num "+x.toString()+" "),console.log(e),e>u){var t=x*u,n=Math.min(u,e-t);O(a.slice(t,t+n))}else O(a),v(0)}),[a,x]),Object(r.useEffect)((function(){}),[j]);var W=function(e){return Object(f.jsxs)("tr",{className:"",children:[Object(f.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(f.jsxs)("td",{className:"noticeEntry",colSpan:"2",onClick:function(){return t=e._id,console.log("selected "+t.toString()),S(y===t?-1:t),void A();var t},children:[" ",e.title]})]},e._id)};return Object(f.jsxs)("div",{id:"notice",children:[Object(f.jsx)("div",{id:"title",children:Object(f.jsx)("h2",{children:e.text.notice})}),y>0&&M&&Object(f.jsx)("div",{id:"noticeContent",children:Object(f.jsx)("table",{className:"content",children:Object(f.jsxs)("tbody",{children:[W(M.notice),Object(f.jsx)("tr",{children:Object(f.jsx)("td",{className:"content",colSpan:"3",children:M.notice.content})})]})})}),Object(f.jsx)("div",{id:"noticeList",children:Object(f.jsx)("table",{children:Object(f.jsx)("tbody",{children:j.length>0&&j.map((function(e){return W(e)}))})})}),a.length>u&&Object(f.jsxs)("div",{id:"pageControl",children:[Object(f.jsx)("div",{className:"page",id:"page",children:Object(f.jsx)(D.a,{fontSize:"large",sx:{color:0===x?"#ffffff":"#404040"},onClick:function(){x>0&&v(x-1)}})}),Object(f.jsx)("div",{className:"pageNum",id:"pageNum",children:x+1}),Object(f.jsx)("div",{className:"page",id:"page",children:Object(f.jsx)(_.a,{fontSize:"large",sx:{color:a.length<=(x+1)*u?"#ffffff":"#404040"},onClick:function(){a.length>(x+1)*u&&v(x+1)}})})]})]})},z=n(26),W=n(395),K=n(10),Q=!1;var Y=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),a=n[0],i=n[1],s=Object(W.a)(a,50),j=Object(l.a)(s,1)[0],O=Object(r.useState)([]),g=Object(l.a)(O,2),p=g[0],x=g[1],v=Object(r.useState)([]),m=Object(l.a)(v,2),k=m[0],y=m[1],S=Object(r.useState)(0),C=Object(l.a)(S,2),w=C[0],I=C[1],E=Object(r.useState)(0),N=Object(l.a)(E,2),L=N[0],R=N[1],T=Object(r.useState)([]),A=Object(l.a)(T,2),U=A[0],P=A[1],M=Object(r.useState)([]),B=Object(l.a)(M,2),H=B[0],F=B[1],q=Object(K.o)().id;function Y(){return V.apply(this,arguments)}function V(){return V=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a,i,s,l,u,b,j=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=!(j.length>0&&void 0!==j[0])||j[0],console.log("All data loaded "+Q),Q=!0,n&&((o=h).type=d.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",d.c.info(e.text.loading,o)),console.log("Done"),r=[],a=e.doc.rent,i=0;i<a.length;i++)r.push({code:a[i].book_id,retDate:a[i].return_date,state:a[i].state});for(u in F(r),s=[],l=e.doc.book)b=l[u],s.push({code:b._id,name:b.title,num:b.num,author:b.author,claim:b.claim,claim_num:b.claim_num,totalName:b.series,category:b.publisher,publish:b.publisher});console.log("Load"),console.log(l.length),P(s);case 15:case"end":return t.stop()}}),t)}))),V.apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?Y(!1):e.doc.setCallback(Y),console.log("BOOK ID: "+q);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Updated id: "+q),i(q||"")}),[q]),Object(r.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(o.a)(Object(c.a)().mark((function t(n){var o,r,a,i,s,l,d,u,h,j;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=[],r=0;case 2:if(!(r<U.length)){t.next=33;break}if(a=U[r],!(o.length>=b)){t.next=6;break}return t.abrupt("break",33);case 6:if(!(a.name&&a.name.toString().includes(n)||a.code===n)){t.next=30;break}i="".concat(a.name," ").concat(a.claim_num),s=e.text.available,l="",d=Object(z.a)(H),t.prev=11,d.s();case 13:if((u=d.n()).done){t.next=20;break}if((h=u.value).code!==a.code){t.next=18;break}return"1"===h.state?(s=e.text.checkedOut,l=e.text.returnDate+" "+h.retDate):"3"===h.state?(s=e.text.overDue,l=e.text.returnDate+" "+h.retDate):s=e.text.notAvailable,t.abrupt("break",20);case 18:t.next=13;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(11),d.e(t.t0);case 25:return t.prev=25,d.f(),t.finish(25);case 28:j={index:r,text:i,name:a.name,code:a.code.toString(),rent:s,retDate:l},o.push(j);case 30:r++,t.next=2;break;case 33:return o.sort((function(e,t){return e.text>t.text})),t.abrupt("return",o);case 35:case"end":return t.stop()}}),t,null,[[11,22,25,28]])})))).apply(this,arguments)}function r(){return(r=Object(o.a)(Object(c.a)().mark((function e(){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=8;break}return e.next=3,t(j);case 3:(n=e.sent).length>0?x(n):x([]),1===n.length&&R(n[0].index),e.next=9;break;case 8:x([]);case 9:I(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}),[j,U,H,e]),Object(r.useEffect)((function(){var e=p.length;if(console.log("Page num "+w.toString()),e>u){var t=w*u,n=Math.min(u,e-t);y(p.slice(t,t+n))}else y(p),I(0)}),[p,w]);var G=function(){var e=Object(o.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1===L||L!==t?(console.log("Select "+t),R(t)):(console.log("Deselect "+t),R(-1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{id:"search",children:[Object(f.jsx)("div",{id:"title",children:Object(f.jsxs)("h2",{children:[" ",e.text.searchTitle," "]})}),Object(f.jsxs)("div",{id:"searchContents",children:[Object(f.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:a,onChange:function(e){i(e.target.value)}}),k.map((function(e){return function(e){var t=e.index!==L,n=U[e.index],r=t?"searchResult":"selectedSearchResult";return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{id:r,onClick:Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(e.index);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:Object(f.jsx)("table",{children:Object(f.jsx)("tbody",{children:Object(f.jsxs)("tr",{className:"searchTr",children:[Object(f.jsxs)("td",{className:"searchTitle",children:[" ",e.text]}),Object(f.jsxs)("td",{className:"searchRent",children:[" ",e.rent," "]})]})})})}),!t&&Object(f.jsx)("div",{children:Object(f.jsx)("table",{children:Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsxs)("td",{children:[n.author," "]}),Object(f.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[n.totalName," ",Object(f.jsx)("b",{children:n.name})," ",n.claim_num," "]})]}),Object(f.jsx)("tr",{children:Object(f.jsxs)("td",{children:[n.code," "]})}),Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:n.publish}),Object(f.jsxs)("td",{colSpan:e.retDate.length>0?"1":"2",children:[n.claim," "]}),e.retDate.length>0&&Object(f.jsx)("td",{children:e.retDate})]})]})})})]},e.code)}(e)}))]}),p.length>u&&Object(f.jsxs)("div",{id:"pageControl",children:[Object(f.jsx)("div",{className:"page",id:"page",children:Object(f.jsx)(D.a,{fontSize:"large",sx:{color:0===w?"#ffffff":"#404040"},onClick:function(){w>0&&I(w-1)}})}),Object(f.jsx)("div",{className:"pageNum",id:"pageNum",children:w+1}),Object(f.jsx)("div",{className:"page",id:"page",children:Object(f.jsx)(_.a,{fontSize:"large",sx:{color:p.length<=(w+1)*u?"#ffffff":"#404040"},onClick:function(){p.length>(w+1)*u&&I(w+1)}})})]})]})},V=(n(243),n(391));var G=function(e){var t=Object(r.useRef)(),n=Object(r.useRef)(),c=Object(r.useRef)(),o=Object(r.useState)(),a=Object(l.a)(o,2),i=a[0],s=a[1],d=Object(r.useState)([0,0]),u=Object(l.a)(d,2),b=u[0],h=u[1];Object(r.useEffect)((function(){i&&(e.onScan(i.data),s(null))}),[i]),Object(r.useEffect)((function(){var e=!0;console.log("Set interval");var t=setInterval((function(){e?requestAnimationFrame(O):console.log("Unmounted reader call")}),2e3);return function(){console.log("Clear interval for reader"),e=!1,clearInterval(t)}}),[]),Object(r.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",zoom:!0,width:480,height:640}}).then((function(e){console.log(e),console.log("TEST");try{t.current.srcObject=e,t.current.setAttribute("playsinline",!0),t.current.play()}catch(n){}})),console.log(window.innerWidth.toString()+"x"+window.innerHeight.toString())}),[t]),Object(r.useEffect)((function(){var e=c.current.getContext("2d"),n=t.current.videoWidth,o=t.current.videoHeight;console.log("Resolution changed "+n.toString()+"x"+o.toString()),j(e,{x:0,y:o/2-75,x1:n,y1:o/2-75},{color:"red",width:5}),j(e,{x:0,y:o/2+75,x1:n,y1:o/2+75},{color:"red",width:5}),j(e,{x:0,y:o/2-75,x1:0,y1:o/2+75},{color:"red",width:5}),j(e,{x:n,y:o-75,x1:n,y1:o/2+75},{color:"red",width:5}),j(e,{x:0,y:3,x1:n,y1:3},{color:"green",width:5}),j(e,{x:3,y:0,x1:3,y1:o},{color:"green",width:5}),j(e,{x:0,y:o-3,x1:n,y1:o-3},{color:"green",width:5}),j(e,{x:n-3,y:0,x1:n-3,y1:o},{color:"green",width:5})}),[b]);var j=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=t.x,o=t.y,r=t.x1,a=t.y1,i=n.color,s=void 0===i?"black":i,l=n.width,d=void 0===l?1:l;e.beginPath(),e.moveTo(c,o),e.lineTo(r,a),e.strokeStyle=s,e.lineWidth=d,e.stroke()};function O(){console.log(t.current.videoHeight.toString()+"x"+t.current.videoWidth);var e=t.current.videoWidth,c=t.current.videoHeight;n.current.height=e,n.current.width=c,n.current.getContext("2d").drawImage(t.current,0,0,n.current.width,n.current.height)}return Object(f.jsxs)("div",{children:[Object(f.jsx)("canvas",{id:"canvas",className:"canvas",ref:n,hidden:!0}),Object(f.jsx)("video",{ref:t}),Object(f.jsx)("canvas",{id:"overlay",className:"overlay",ref:c}),Object(f.jsx)("div",{id:"text",children:"Test 0"}),Object(f.jsx)("button",{id:"button",type:"button",onClick:function(){return function(){console.log("Capture");var e=n.current.getContext("2d"),o=t.current.videoWidth,r=t.current.videoHeight;n.current.width=o,n.current.height=r,e.drawImage(t.current,0,0,n.current.width,n.current.height),c.current.height=t.current.videoHeight,c.current.width=t.current.videoWidth,h([o,r]);var a=n.current.toDataURL("image/png");Object(V.a)({method:"post",mode:"no-cors",crossDomain:"true",url:"https://10.0.0.68:8080/uploadImage",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json","Access-Control-Allow-Methods":"GET, PUT, POST, DELETE, OPTIONS"},withCredentials:!1,credentials:"same-origin",data:{image:a}})}()},children:" Capture "})]})},Z=n(30),J={LoggedOut:0,LoggingIn:1,LoggedIn:2};var X=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1],u=Object(r.useState)(""),b=Object(l.a)(u,2),j=b[0],g=b[1],p=Object(r.useState)([]),x=Object(l.a)(p,2),v=x[0],m=x[1],k=Object(r.useState)(!1),y=Object(l.a)(k,2),S=y[0],C=y[1],w=Object(r.useState)(""),E=Object(l.a)(w,2),D=E[0],N=E[1],_=Object(r.useState)(J.LoggedOut),L=Object(l.a)(_,2),R=L[0],T=L[1],A=Object(r.useState)([]),U=Object(l.a)(A,2),B=U[0],H=U[1],F=Object(r.useState)(!1),q=Object(l.a)(F,2),z=q[0],W=q[1],K=Object(I.a)(P,{variables:{_id:D}}),Q=Object(l.a)(K,2),Y=Q[0],V=Q[1].data,G=Object(I.a)(M,{variables:{user_id:D}}),X=Object(l.a)(G,2),$=X[0],ee=X[1].data,te=Object(r.useState)(""),ne=Object(l.a)(te,2),ce=ne[0],oe=ne[1],re=Object(r.useState)(""),ae=Object(l.a)(re,2),ie=ae[0],se=ae[1];function le(){return de.apply(this,arguments)}function de(){return de=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r,a=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!(a.length>0&&void 0!==a[0])||a[0],console.log("All data loaded "+S),!e.doc.logged){t.next=11;break}return T(J.LoggedIn),o=e.doc.userInfo._id,N(o),m(e.doc.getRent(o)),t.next=9,$();case 9:t.next=14;break;case 11:T(J.LoggedOut),N(""),g("");case 14:n&&((r=h).type=d.c.TYPE.SUCCESS,r.render=e.text.succeededToOpen,r.autoClose=3e3,r.toastId="",d.c.info(e.text.succeededToOpen,r)),console.log("Set title "+e.logged),e.doc.logged?e.doc.adminMode?se(e.text.userSearch):se(e.text.checkOut):se(e.text.logIn),console.log("Done"),C(!0);case 19:case"end":return t.stop()}}),t)}))),de.apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){var n,o;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?le(!1):e.doc.setCallback(le),console.log("======================================="),console.log("CheckOut initialize"),"autoLogin"in e.context.cookie&&(n="true"===e.context.cookie.autoLogin,W(n)),o=new Date,2,o.setTime(o.getTime()+1728e5),oe(o.toGMTString());case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("User data updated "),le(!1)}),[e.logged]),Object(r.useEffect)((function(){console.log("User data updated "),he()}),[V]),Object(r.useEffect)((function(){var t=[];if(ee&&e.doc.bookReady&&e.doc.rentReady){console.log("History updated ");for(var n=0;n<ee.rentLogs.length;n++){var c=ee.rentLogs[n];if("0"===c.book_state||"1"===c.book_state){var o=c.book_id,r=c.timestamp.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:o,title:e.doc.book[o].title,date:r,state:c.book_state})}}t.sort((function(e,t){return e.date>t.date}));for(var a=[],i=0;i<t.length-1;i++)if("1"===t[i].state)for(var s=t[i],l=s.id,d=i+1;d<t.length;d++)if("0"===t[d].state&&l===t[d].id){a.push({id:s.id,title:s.title,rentDate:s.date,retDate:t[d].date});break}console.log("Set history"),H(a)}}),[ee,e.doc.bookReady,e.doc.rentReady]);var ue=function(t){return Object(f.jsx)("div",{children:Object(f.jsx)("table",{children:Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{id:"id",children:e.text.id}),Object(f.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(f.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,i=t.toString();return Object(f.jsxs)(a.a.Fragment,{children:[Object(f.jsxs)("tr",{className:"bookData",children:[Object(f.jsx)("td",{className:"bookData",children:Object(f.jsx)(Z.b,{to:"/search/"+n,children:n})}),Object(f.jsx)("td",{className:"bookData",children:c}),Object(f.jsx)("td",{className:"bookData",children:o})]},i),Object(f.jsx)("tr",{className:"bookName",children:Object(f.jsx)("td",{colSpan:"3",className:"bookName",children:r})},i+"Title")]},i+"Fragment")}(e,t)})),0===t.length&&Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},be=function(){var e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(J.LoggingIn),N(i.toUpperCase()),e.next=4,Y();case 4:return e.next=6,$();case 6:console.log("Log In"),he();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){if(V&&R!==J.LoggedOut){console.log(d.c.isActive(O));var t,n=h;e.context.checkLogIn(V,j)?(e.doc.logIn(V.user),m(e.doc.getRent(D)),T(J.LoggedIn),n.type=d.c.TYPE.SUCCESS,t=e.text.logInSucceed,document.cookie="user_id="+D+"; expires="+ce+";"):(n.type=d.c.TYPE.ERROR,t=e.text.logInFail),n.render=t,n.autoClose=3e3,n.toastId=O,d.c.isActive(O)?(console.log("update toast"),d.c.update(O,n)):(console.log("New toast"),d.c.info(t,n))}};return Object(f.jsxs)("div",{id:"checkOut",children:[Object(f.jsx)("div",{id:"title",children:Object(f.jsx)("h2",{children:ie})}),Object(f.jsxs)("div",{id:"checkOutInput",hidden:R===J.LoggedIn,children:[Object(f.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:i,disabled:!S,onInput:function(e){s(e.target.value)}}),Object(f.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:j,disabled:!S,onInput:function(e){g(e.target.value)}}),Object(f.jsxs)("div",{id:"autoLogin",children:[Object(f.jsx)("input",{type:"checkbox",id:"autoLoginButton",checked:z,onChange:function(){return function(){console.log("Toggle autoLogin");var e="autoLogin="+(z?"false":"true")+"; expires="+ce+";";console.log(e),document.cookie=e,W(!z)}()}}),Object(f.jsx)("label",{children:e.text.autoLogin})]}),Object(f.jsxs)("button",{id:"logIn",onClick:Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",be());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(f.jsxs)("div",{id:"checkOutResult",hidden:R!==J.LoggedIn,children:[Object(f.jsx)(Z.b,{className:"menu-items",to:"/barcodeReader",children:"Scan"}),Object(f.jsx)("div",{children:ue(v)}),Object(f.jsx)("div",{id:"name",children:e.text.history}),Object(f.jsx)("div",{children:ue(B)})]})]})};var $=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1],u=Object(W.a)(i,50),j=Object(l.a)(u,1)[0],O=Object(r.useState)([]),g=Object(l.a)(O,2),p=g[0],x=g[1],v=Object(r.useState)(!1),m=Object(l.a)(v,2),k=m[0],y=m[1],S=Object(r.useState)(""),C=Object(l.a)(S,2),E=C[0],D=(C[1],Object(r.useState)([])),N=Object(l.a)(D,2),_=(N[0],N[1]),L=Object(w.b)(U),R=L.loading,T=L.data,A=L.error,B=Object(I.a)(P,{variables:{_id:E}}),H=Object(l.a)(B,2),F=(H[0],H[1].data),q=Object(I.a)(M,{variables:{user_id:E}}),z=Object(l.a)(q,2),K=(z[0],z[1].data),Q=Object(r.useState)({}),Y=Object(l.a)(Q,2),V=Y[0],G=Y[1],J=Object(r.useState)(""),X=Object(l.a)(J,2),$=(X[0],X[1],Object(r.useState)(0)),ee=Object(l.a)($,2),te=(ee[0],ee[1]),ne=Object(r.useState)(0),ce=Object(l.a)(ne,2),oe=ce[0],re=ce[1],ae=Object(r.useState)([]),ie=Object(l.a)(ae,2),se=ie[0],le=ie[1];function de(){return ue.apply(this,arguments)}function ue(){return ue=Object(o.a)(Object(c.a)().mark((function t(){var n,o,r=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(r.length>0&&void 0!==r[0])||r[0],console.log("All data loaded "+k),n&&((o=h).type=d.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",d.c.info(e.text.succeededToOpen,o)),console.log("Set title "+e.logged),console.log("Done"),y(!0);case 6:case"end":return t.stop()}}),t)}))),ue.apply(this,arguments)}Object(r.useEffect)((function(){function t(){return(t=Object(o.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?de(!1):e.doc.setCallback(de),console.log("======================================="),console.log("UserSearch initialize");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("User data updated "),de(!1)}),[e.logged]),Object(r.useEffect)((function(){console.log("User data updated ")}),[F]),Object(r.useEffect)((function(){if(console.log("User list loaded"),console.log(A),console.log(R),T){var t=[];console.log("User list available");for(var n={0:e.text.normal,1:e.text.overDue,2:e.text.stopped},c=0;c<T.users.length;c++){var o=T.users[c],r={id:o._id,name:o.name,level:o.level,state:n[o.state]};t.push(r)}console.log(t),e.doc.setUser(t),console.log(e.doc.getUser()),G(e.doc.getUser())}}),[T,R,A]),Object(r.useEffect)((function(){var t=[];if(K&&e.doc.bookReady&&e.doc.rentReady){console.log("History updated ");for(var n=0;n<K.rentLogs.length;n++){var c=K.rentLogs[n];if("0"===c.book_state||"1"===c.book_state){var o=c.book_id,r=c.timestamp.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:o,title:e.doc.book[o].title,date:r,state:c.book_state})}}t.sort((function(e,t){return e.date>t.date}));for(var a=[],i=0;i<t.length-1;i++)if("1"===t[i].state)for(var s=t[i],l=s.id,d=i+1;d<t.length;d++)if("0"===t[d].state&&l===t[d].id){a.push({id:s.id,title:s.title,rentDate:s.date,retDate:t[d].date});break}console.log("Set history"),_(a)}}),[K,e.doc.bookReady,e.doc.rentReady]);var be,he=function(){var t=Object(o.a)(Object(c.a)().mark((function t(n){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:-1===oe||oe!==n?(console.log("Select "+n),re(n),le(e.doc.getRent(p[n].id))):(console.log("Deselect "+n),re(-1));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),je=function(t){return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("table",{children:Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{id:"id",children:e.text.id}),Object(f.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(f.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,o=e.retDate,r=e.title,i=t.toString();return Object(f.jsxs)(a.a.Fragment,{children:[Object(f.jsxs)("tr",{className:"bookData",children:[Object(f.jsx)("td",{className:"bookData",children:Object(f.jsx)(Z.b,{to:"/search/"+n,children:n})}),Object(f.jsx)("td",{className:"bookData",children:c}),Object(f.jsx)("td",{className:"bookData",children:o})]},i),Object(f.jsx)("tr",{className:"bookName",children:Object(f.jsx)("td",{colSpan:"3",className:"bookName",children:r})},i+"Title")]},i+"Fragment")}(e,t)})),0===t.length&&Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})};return Object(r.useEffect)((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(o.a)(Object(c.a)().mark((function e(t){var n,o,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=Object(c.a)().keys(V);case 2:if((e.t1=e.t0()).done){e.next=10;break}if(o=e.t1.value,r=V[o],!(n.length>=b)){e.next=7;break}return e.abrupt("break",10);case 7:(r.name&&r.name.toString().includes(t)||r.id.toLowerCase()===t.toLowerCase())&&n.push(r),e.next=2;break;case 10:return n.sort((function(e,t){return e.text>t.text})),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return(n=Object(o.a)(Object(c.a)().mark((function t(){var n;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!j){t.next=8;break}return t.next=3,e(j);case 3:(n=t.sent).length>0?x(n):x([]),1===n.length&&re(n[0].index),t.next=9;break;case 8:x([]);case 9:te(0);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[j,e]),Object(f.jsxs)("div",{id:"checkOut",children:[Object(f.jsx)("div",{id:"title",children:Object(f.jsx)("h2",{children:e.text.userSearch})}),Object(f.jsxs)("div",{id:"checkOutInput",hidden:!e.doc.adminMode,children:[Object(f.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:i,onChange:function(e){s(e.target.value)}}),Object(f.jsx)("div",{children:(be=p,Object(f.jsxs)("div",{children:[be.map((function(e,t){return function(e,t){var n=t.toString();return Object(f.jsxs)("div",{children:[Object(f.jsx)("table",{children:Object(f.jsx)("tbody",{children:Object(f.jsxs)("tr",{className:"searchTr",onClick:Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:[Object(f.jsx)("td",{className:"bookData",children:e.id}),Object(f.jsx)("td",{className:"bookData",children:e.name}),Object(f.jsx)("td",{className:"bookData",children:e.state}),Object(f.jsx)("td",{className:"bookData",children:e.rent})]},n)})}),t===oe&&je(se)]})}(e,t)})),0===be.length&&Object(f.jsx)("table",{children:Object(f.jsx)("tbody",{children:Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")})})]}))})]})]})},ee=(n(247),n(11)),te=n(12),ne=function(){function e(){var t=this;Object(ee.a)(this,e),console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.userReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.logCallback=void 0,this.admin=!1,this.adminMode=!1,this.serverInfo={},this.serverAvailable=!1,this.ipAddr="",V.a.get("https://api.ipify.org/?format=json").then((function(e){console.log("Get IP Address"),console.log(e.data);var n=e.data.ip;t.updateIpAddr(n)}))}return Object(te.a)(e,[{key:"updateIpAddr",value:function(e){console.log("IP addr updated "+e),this.ipAddr=e,this.checkServerIp()}},{key:"checkServerIp",value:function(){if(0!=this.ipAddr.length&&this.serverInfo.globalIp&&this.serverInfo.globalIp===this.ipAddr){console.log("Server is accessible "+this.serverInfo.localIp),this.serverAvailable=!0;var e="https://"+this.serverInfo.localIp+":"+this.serverInfo.port+"/check";V.a.get(e).then((function(e){console.log("Server connected"),console.log(e.data)}))}}},{key:"checkState",value:function(){this.bookReady&&this.rentReady&&(this.initialized=!0,this.callback&&(d.c.dismiss(),this.callback()))}},{key:"setLogCallback",value:function(e){this.logCallback=e}},{key:"setRent",value:function(e){this.rent=e,this.rentReady=!0,this.checkState()}},{key:"setServerInfo",value:function(e){this.serverInfo=e,console.log(this.serverInfo.globalIp),this.checkServerIp()}},{key:"setBook",value:function(e){this.book={};for(var t=0;t<e.length;t++){var n=e[t],c=n._id;this.book[c]=n}this.bookReady=!0,this.checkState()}},{key:"setUser",value:function(e){this.user={};for(var t=0;t<e.length;t++){var n=e[t],c=n.id;this.user[c]=n,this.user[c].rent=0}this.checkRent(),this.userReady=!0}},{key:"checkRent",value:function(){if(this.userReady&&this.rentReady){console.log(this.rent);for(var e=0;e<this.rent.length;e++){var t=this.rent[e].state;if("1"===t||"3"===t){var n=this.rent[e].user_id;console.log(n),console.log(n.length),n&&n.length>0&&n in this.user?this.user[n].rent+=1:this.user[n].rent=1}}console.log(this.user)}}},{key:"setAdminMode",value:function(e){this.adminMode=e,this.logCallback&&this.logCallback(!0)}},{key:"logIn",value:function(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,"2"===e.level&&(this.admin=!0),this.logCallback&&this.logCallback(!0)}},{key:"logOut",value:function(){console.log("Logged out"),this.logged=!1,this.userInfo={},this.logCallback&&this.logCallback(!1)}},{key:"getRent",value:function(e){var t=[];if(console.log("Check "+e),!this.bookReady)return t;for(var n=0;n<this.rent.length;n++){var c=this.rent[n];if(c.user_id===e){var o=c.book_id,r=this.book[o],a={};a.id=r._id,a.title=r.title,a.rentDate=c.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),a.retDate=c.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),t.push(a)}}return t}},{key:"getUser",value:function(){return this.user}},{key:"openDoc",value:function(){var e=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.initialized=!0,e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.initialized}},{key:"setCallback",value:function(e){console.log("Update function registered"),this.callback=e}}]),e}(),ce=ne,oe=n(216),re=new(n(248))(oe.privateKey),ae=function(){function e(){Object(ee.a)(this,e),console.log("Create Context"),console.log("Cookies");var t=document.cookie;this.cookie=t.split(";").map((function(e){return e.split("=")})).reduce((function(e,t){var n=t.shift().trim(),c=t.join("=").trim();return e[decodeURIComponent(n)]=decodeURIComponent(c),e}),{}),console.log(this.cookie)}return Object(te.a)(e,[{key:"checkLogIn",value:function(e,t){var n,c=!1;if(e.user&&t.length>0){console.log("User data available");var o=e.user.encrypted_email,r=e.user.encrypted_phone;if(n=re.sign(t,"base64"),t===o||t===r)n=t,c=!0;else if(o===n)c=!0;else{for(var a="",i=0;i<t.length;i++)isNaN(t[i])||(a+=t[i]);(n=re.sign(a,"base64"))===r&&(c=!0)}}if(c){var s=new Date;s.setTime(s.getTime()+1728e5);var l=s.toGMTString();document.cookie="password="+n+"; expires="+l+";"}return c}}]),e}(),ie=n(149),se=n(217);n(368),n(369);var le=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1],a=Object(r.useState)(!1),i=Object(l.a)(a,2),s=i[0],d=i[1];Object(r.useEffect)((function(){c!==e.dropdown&&(console.log("User clicked"),console.log(e.dropdown),d(!s),o(e.dropdown));var t=document.getElementById("dropdown-menu");s?t.classList.add("is-show"):t.classList.remove("is-show")}),[e.dropdown,c,s]);var u=function(){console.log("Return book"),window.history.back()};return Object(f.jsxs)("div",{id:"dropdown-menu",onClick:function(){d(!s)},className:"dropdown-menu",children:[e.logged&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(f.jsx)(Z.b,{className:"menu-items",to:"/",onClick:function(){return d(!1)},children:e.text.home}),Object(f.jsx)(Z.b,{className:"menu-items",to:"/notice",onClick:function(){return d(!1)},children:e.text.notice}),!e.doc.adminMode&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Z.b,{className:"menu-items",to:"/search",onClick:function(){return d(!1)},children:e.text.bookSearch}),Object(f.jsxs)(Z.b,{className:"menu-items",to:"/checkOut",onClick:function(){return d(!1)},children:[e.doc.serverAvailable&&e.text.checkOut,!e.doc.serverAvailable&&e.text.checkOutStatus]}),e.doc.serverAvailable&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{className:"menu-items",onClick:function(){return u()},children:e.text.return})})]}),e.doc.adminMode&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(Z.b,{className:"menu-items",to:"/userSearch",onClick:function(){return d(!1)},children:e.text.userSearch})}),e.doc.admin&&Object(f.jsxs)("div",{className:"menu-items",onClick:function(){!0===e.doc.admin?e.doc.setAdminMode(!e.doc.adminMode):e.doc.setAdminMode(!1)},children:[e.doc.adminMode&&e.text.userMode,!e.doc.adminMode&&e.text.adminMode]}),Object(f.jsx)("div",{className:"menu-items",onClick:function(){return d(!1),e.doc.logOut(),document.cookie="user_id=",document.cookie="password=",void(document.cookie="autoLogin=false")},children:e.text.logOut})]}),!e.logged&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(Z.b,{className:"menu-items",to:"/",onClick:function(){return d(!1)},children:e.text.home}),Object(f.jsx)(Z.b,{className:"menu-items",to:"/notice",onClick:function(){return d(!1)},children:e.text.notice}),Object(f.jsx)(Z.b,{className:"menu-items",to:"/checkOut",onClick:function(){return d(!1)},children:e.text.logIn}),Object(f.jsx)(Z.b,{className:"menu-items",to:"/search",onClick:function(){return d(!1)},children:e.text.bookSearch}),e.doc.serverAvailable&&Object(f.jsx)("div",{className:"menu-items",onClick:function(){return u()},children:e.text.return})]})]})},de=n(218),ue=n.n(de);var be=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],o=n[1];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(f.jsx)("div",{className:"title",children:se.isMobile?Object(f.jsx)("h1",{children:e.text.titleShort}):Object(f.jsx)("h1",{children:e.text.titleLong})}),Object(f.jsx)("div",{className:"menu",onClick:function(){var e=document.getElementById("navbar").style.maxWidth;console.log("maxWidth"),console.log(e),console.log(document.getElementById("navbar").style.width),o(!c)},children:Object(f.jsx)(ue.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(f.jsx)(le,{text:e.text,doc:e.doc,logged:e.logged,dropdown:c})]})})},he=new ce,je=new ae,Oe={},fe="";var ge=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(""),s=Object(l.a)(i,2),u=s[0],b=s[1],O=Object(w.b)(A),g=O.loading,p=O.error,x=O.data,v=Object(w.b)(T),m=v.loading,k=v.error,y=v.data,S=Object(w.b)(F),E=S.loading,D=S.error,N=S.data,_=Object(I.a)(P,{variables:{_id:u}}),L=Object(l.a)(_,2),R=L[0],U=L[1].data;function M(e){console.log("==== Update logging state "+he.logged),console.log(he.userInfo),a(he.logged)}return Object(r.useEffect)((function(){function e(){return(e=Object(o.a)(Object(c.a)().mark((function e(){var t,n,o,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in console.log("Initialize app"),fe+="<p>Initialize app</p>",console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/hkmcclib",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.5.1"}).APP_NAME),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/hkmcclib",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.5.1"}).APP_VERSION),t=navigator.languages,console.log(t),n={},n=t.length>0&&(t[0].toLowerCase().includes("kr")||t[0].toLowerCase().includes("ko"))?ie.kr:ie.en)Oe[o]=n[o];"autoLogin"in je.cookie&&"true"===je.cookie.autoLogin&&(console.log("Auto Login: "+je.cookie.user_id),b(je.cookie.user_id),console.log(je.cookie.nothing)),(r=h).type=d.c.TYPE.LOADING,r.autoClose=!1,r.toastId=j,d.c.loading(Oe.loading,r),he.setLogCallback(M),R();case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[R]),Object(r.useEffect)((function(){console.log("User data loaded"),U&&(console.log("Login check "+je.cookie.password),console.log(U),je.cookie.password&&je.checkLogIn(U,je.cookie.password)&&(console.log("Login suceeded"),he.logIn(U.user)))}),[U]),Object(r.useEffect)((function(){console.log("Rent Query Updated"),fe=fe+"<p>Rent Query Updated "+g+" "+p+"</p>",console.log(g),console.log(p),x&&(console.log("Rent available"),fe+="<p>Rent available</p>",he.setRent(x.rents))}),[g,p,x]),Object(r.useEffect)((function(){console.log("Book Query Updated"),fe+="<p>Book Query Updated</p>",console.log(m),console.log(k),y&&(console.log("Book available"),fe+="<p>Book available</p>",he.setBook(y.books))}),[m,k,y]),Object(r.useEffect)((function(){console.log("Server Query Updated"),fe+="<p>Server Query Updated</p>",console.log(E),console.log(D),N&&(console.log("Server info available"),fe+="<p>Server info available</p>",console.log(N.serverInfo),he.setServerInfo(N.serverInfo))}),[E,D,N]),Object(f.jsx)(Z.a,{children:Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(be,{doc:he,text:Oe,logged:n}),Object(f.jsxs)(K.c,{children:[Object(f.jsx)(K.a,{path:"/",element:Object(f.jsx)(C,{doc:he,text:Oe})}),Object(f.jsx)(K.a,{path:"/notice",element:Object(f.jsx)(q,{doc:he,text:Oe})}),Object(f.jsx)(K.a,{path:"/search/:id?",element:Object(f.jsx)(Y,{doc:he,text:Oe})}),Object(f.jsx)(K.a,{path:"/checkOut",element:Object(f.jsx)(X,{context:je,doc:he,text:Oe,logged:n})}),Object(f.jsx)(K.a,{path:"/userSearch",element:Object(f.jsx)($,{context:je,doc:he,text:Oe})}),Object(f.jsx)(K.a,{path:"/barcodeReader",element:Object(f.jsx)(G,{context:je,doc:he,text:Oe})})]}),Object(f.jsx)("div",{children:Object(f.jsx)(d.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:d.b,limit:2})}),Object(f.jsxs)("h3",{children:["v ","0.5.1"]})]})})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,396)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),r(e),a(e)}))},xe=n(150),ve=n(393),me=n(392),ke=n(394),ye=n(390),Se="data-xaque",Ce="https://realm.mongodb.com/api/client/v2.0/app/".concat(Se,"/graphql"),we=new xe.a(Se);function Ie(){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(o.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(we.currentUser){e.next=5;break}return e.next=3,we.logIn(xe.b.anonymous());case 3:e.next=7;break;case 5:return e.next=7,we.currentUser.refreshAccessToken();case 7:return e.abrupt("return",we.currentUser.accessToken);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var De=new ve.a({link:new me.a({uri:Ce,fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(o.a)(Object(c.a)().mark((function e(t,n){var o;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie();case 2:return o=e.sent,n.headers.Authorization="Bearer ".concat(o),e.abrupt("return",fetch(t,n));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),cache:new ke.a});s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(ye.a,{client:De,children:Object(f.jsx)(ge,{})})}),document.getElementById("root")),pe()},94:function(e,t,n){}},[[371,1,2]]]);
//# sourceMappingURL=main.8f3787bf.chunk.js.map