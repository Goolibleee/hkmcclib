(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[0],{112:function(e,t,n){},143:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOut":"Check Out","checkOutTitle":"Check Out Status","search":"Search","searchTitle":"Book Search","history":"Rent History","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Over due","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","noEntry":"No entry","notice":"Notice","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOut":"\ub300\ucd9c\uae30\ub85d","checkOutTitle":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","search":"\ub3c4\uc11c\uac80\uc0c9","searchTitle":"\ub3c4\uc11c \uac80\uc0c9","history":"\ub300\ucd9c \uc774\ub825","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0\uc0ac\ud56d","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>"}}')},210:function(e){e.exports=JSON.parse('{"privateKey":"-----BEGIN RSA PRIVATE KEY-----\\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\\n-----END RSA PRIVATE KEY-----\\n"}')},228:function(e,t,n){},229:function(e,t,n){},230:function(e,t,n){},241:function(e,t){},244:function(e,t){},255:function(e,t){},257:function(e,t){},284:function(e,t){},286:function(e,t){},287:function(e,t){},292:function(e,t){},294:function(e,t){},300:function(e,t){},302:function(e,t){},321:function(e,t){},333:function(e,t){},336:function(e,t){},359:function(e,t,n){},360:function(e,t,n){},362:function(e,t,n){"use strict";n.r(t);var c=n(4),a=n(8),o=n(0),r=n.n(o),i=n(95),s=n.n(i),l=(n(228),n(7)),u=n(51),d=(n(229),n(22)),b=(n(230),10),j=500;String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var h={position:"bottom-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},O="custom-loading-id",f="custom-logging-id",p=n(3);var g,x,m=function(e){function t(){return n.apply(this,arguments)}function n(){return n=Object(a.a)(Object(c.a)().mark((function t(){var n,a,o=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(o.length>0&&void 0!==o[0])||o[0],console.log("All data loaded "),n&&((a=h).type=d.c.TYPE.SUCCESS,a.render=e.text.succeededToOpen,a.autoClose=3e3,a.toastId="",d.c.info(e.text.succeededToOpen,a)),console.log("Done");case 4:case"end":return t.stop()}}),t)}))),n.apply(this,arguments)}return Object(o.useEffect)((function(){function n(){return(n=Object(a.a)(Object(c.a)().mark((function n(){return Object(c.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log("Home"),e.doc.isOpen()?t(!1):e.doc.setCallback(t);case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[]),Object(p.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},v=(n(112),n(53)),k=n(216),y=n(378),S=n(103),C=n.n(S),E=n(104),_=n.n(E),I=Object(v.a)(g||(g=Object(u.a)(["\n    query GetNotices {\n        notices (sortBy: _ID_DESC, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),w=Object(v.a)(x||(x=Object(u.a)(["\n    query GetContent ($_id: String!) {\n        notice (query: {_id: $_id}) {\n            _id\n            date\n            title\n            content\n        }\n    }"])));var D=function(e){var t=Object(o.useState)([]),n=Object(l.a)(t,2),r=n[0],i=n[1],s=Object(o.useState)([]),u=Object(l.a)(s,2),j=u[0],O=u[1],f=Object(o.useState)(0),g=Object(l.a)(f,2),x=g[0],m=g[1],v=Object(o.useState)(-1),S=Object(l.a)(v,2),E=S[0],D=S[1],N=Object(k.b)(I),T=N.loading,R=N.data,L=N.error,A=Object(y.a)(w,{variables:{_id:E}}),P=Object(l.a)(A,2),B=P[0],U=P[1],H=U.loading,q=U.data,z=U.error;function F(){return M.apply(this,arguments)}function M(){return M=Object(a.a)(Object(c.a)().mark((function t(){var n,a,o=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(o.length>0&&void 0!==o[0])||o[0],console.log("All data loaded "),n&&((a=h).type=d.c.TYPE.SUCCESS,a.render=e.text.succeededToOpen,a.autoClose=3e3,a.toastId="",d.c.info(e.text.succeededToOpen,a)),console.log("Done");case 4:case"end":return t.stop()}}),t)}))),M.apply(this,arguments)}Object(o.useEffect)((function(){function t(){return(t=Object(a.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Notice"),e.doc.isOpen()?F(!1):e.doc.setCallback(F);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(o.useEffect)((function(){console.log("Get Notice"),R&&i(R.notices)}),[R,L,T]),Object(o.useEffect)((function(){console.log("Get Content")}),[q,z,H]),Object(o.useEffect)((function(){var e=r.length;if(console.log("Page num "+x.toString()+" "),console.log(e),e>b){var t=x*b,n=Math.min(b,e-t);O(r.slice(t,t+n))}else O(r),m(0)}),[r,x]),Object(o.useEffect)((function(){}),[j]);var K=function(e){return Object(p.jsxs)("tr",{className:"",children:[Object(p.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(p.jsxs)("td",{className:"",colSpan:"2",onClick:function(){return t=e._id,console.log("selected "+t.toString()),D(t),void B();var t},children:[" ",e.title]})]},e._id)};return Object(p.jsxs)("div",{id:"notice",children:[Object(p.jsx)("div",{id:"title",children:Object(p.jsx)("h2",{children:e.text.notice})}),E>0&&q&&Object(p.jsx)("div",{children:Object(p.jsx)("table",{className:"content",children:Object(p.jsxs)("tbody",{children:[K(q.notice),Object(p.jsx)("tr",{children:Object(p.jsx)("td",{className:"content",colSpan:"3",children:q.notice.content})})]})})}),Object(p.jsx)("div",{id:"list",children:Object(p.jsx)("table",{children:Object(p.jsx)("tbody",{children:j.length>0&&j.map((function(e){return K(e)}))})})}),r.length>b&&Object(p.jsxs)("div",{id:"pageControl",children:[Object(p.jsx)("div",{className:"page",id:"page",children:Object(p.jsx)(C.a,{fontSize:"large",sx:{color:0===x?"#ffffff":"#404040"},onClick:function(){x>0&&m(x-1)}})}),Object(p.jsx)("div",{className:"pageNum",id:"pageNum",children:x+1}),Object(p.jsx)("div",{className:"page",id:"page",children:Object(p.jsx)(_.a,{fontSize:"large",sx:{color:r.length<=(x+1)*b?"#ffffff":"#404040"},onClick:function(){r.length>(x+1)*b&&m(x+1)}})})]})]})},N=n(24),T=n(386),R=n(9),L=!1;var A,P,B=function(e){var t=Object(o.useState)(""),n=Object(l.a)(t,2),r=n[0],i=n[1],s=Object(T.a)(r,50),u=Object(l.a)(s,1)[0],O=Object(o.useState)([]),f=Object(l.a)(O,2),g=f[0],x=f[1],m=Object(o.useState)([]),v=Object(l.a)(m,2),k=v[0],y=v[1],S=Object(o.useState)(0),E=Object(l.a)(S,2),I=E[0],w=E[1],D=Object(o.useState)(0),A=Object(l.a)(D,2),P=A[0],B=A[1],U=Object(o.useState)([]),H=Object(l.a)(U,2),q=H[0],z=H[1],F=Object(o.useState)([]),M=Object(l.a)(F,2),K=M[0],Q=M[1],V=Object(R.o)().id;function Y(){return W.apply(this,arguments)}function W(){return W=Object(a.a)(Object(c.a)().mark((function t(){var n,a,o,r,i,s,l,u,b,j=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=!(j.length>0&&void 0!==j[0])||j[0],console.log("All data loaded "+L),L=!0,n&&((a=h).type=d.c.TYPE.SUCCESS,a.render=e.text.succeededToOpen,a.autoClose=3e3,a.toastId="",d.c.info(e.text.loading,a)),console.log("Done"),o=[],r=e.doc.rent,i=0;i<r.length;i++)o.push({code:r[i].book_id,retDate:r[i].return_date,state:r[i].state});for(u in Q(o),s=[],l=e.doc.book)b=l[u],s.push({code:b._id,name:b.title,num:b.num,author:b.author,claim:b.claim,claim_num:b.claim_num,totalName:b.series,category:b.publisher,publish:b.publisher});console.log("Load"),console.log(l.length),z(s);case 15:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}Object(o.useEffect)((function(){function t(){return(t=Object(a.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?Y(!1):e.doc.setCallback(Y),console.log("BOOK ID: "+V);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(o.useEffect)((function(){console.log("Updated id: "+V),i(V||"")}),[V]),Object(o.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(a.a)(Object(c.a)().mark((function t(n){var a,o,r,i,s,l,u,d,b,h;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],o=0;case 2:if(!(o<q.length)){t.next=33;break}if(r=q[o],!(a.length>=j)){t.next=6;break}return t.abrupt("break",33);case 6:if(!(r.name&&r.name.toString().includes(n)||r.code===n)){t.next=30;break}i="".concat(r.name," ").concat(r.claim_num),s=e.text.available,l="",u=Object(N.a)(K),t.prev=11,u.s();case 13:if((d=u.n()).done){t.next=20;break}if((b=d.value).code!==r.code){t.next=18;break}return"1"===b.state?(s=e.text.checkedOut,l=e.text.returnDate+" "+b.retDate):"3"===b.state?(s=e.text.overDue,l=e.text.returnDate+" "+b.retDate):s=e.text.notAvailable,t.abrupt("break",20);case 18:t.next=13;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(11),u.e(t.t0);case 25:return t.prev=25,u.f(),t.finish(25);case 28:h={index:o,text:i,name:r.name,code:r.code.toString(),rent:s,retDate:l},a.push(h);case 30:o++,t.next=2;break;case 33:return a.sort((function(e,t){return e.text>t.text})),t.abrupt("return",a);case 35:case"end":return t.stop()}}),t,null,[[11,22,25,28]])})))).apply(this,arguments)}function o(){return(o=Object(a.a)(Object(c.a)().mark((function e(){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=8;break}return e.next=3,t(u);case 3:(n=e.sent).length>0?x(n):x([]),1===n.length&&B(n[0].index),e.next=9;break;case 8:x([]);case 9:w(0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){o.apply(this,arguments)}()}),[u,q,K,e]),Object(o.useEffect)((function(){var e=g.length;if(console.log("Page num "+I.toString()),e>b){var t=I*b,n=Math.min(b,e-t);y(g.slice(t,t+n))}else y(g),w(0)}),[g,I]);var G=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:-1===P||P!==t?(console.log("Select "+t),B(t)):(console.log("Deselect "+t),B(-1));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{id:"search",children:[Object(p.jsx)("div",{id:"title",children:Object(p.jsxs)("h2",{children:[" ",e.text.searchTitle," "]})}),Object(p.jsxs)("div",{id:"searchContents",children:[Object(p.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:r,onChange:function(e){i(e.target.value)}}),k.map((function(e){return function(e){var t=e.index!==P,n=q[e.index],o=t?"searchResult":"selectedSearchResult";return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{id:o,onClick:Object(a.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,G(e.index);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:Object(p.jsx)("table",{children:Object(p.jsx)("tbody",{children:Object(p.jsxs)("tr",{className:"searchTr",children:[Object(p.jsxs)("td",{className:"searchTitle",children:[" ",e.text]}),Object(p.jsxs)("td",{className:"searchRent",children:[" ",e.rent," "]})]})})})}),!t&&Object(p.jsx)("div",{children:Object(p.jsx)("table",{children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[n.author," "]}),Object(p.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[n.totalName," ",Object(p.jsx)("b",{children:n.name})," ",n.claim_num," "]})]}),Object(p.jsx)("tr",{children:Object(p.jsxs)("td",{children:[n.code," "]})}),Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:n.publish}),Object(p.jsxs)("td",{colSpan:e.retDate.length>0?"1":"2",children:[n.claim," "]}),e.retDate.length>0&&Object(p.jsx)("td",{children:e.retDate})]})]})})})]},e.code)}(e)}))]}),g.length>b&&Object(p.jsxs)("div",{id:"pageControl",children:[Object(p.jsx)("div",{className:"page",id:"page",children:Object(p.jsx)(C.a,{fontSize:"large",sx:{color:0===I?"#ffffff":"#404040"},onClick:function(){I>0&&w(I-1)}})}),Object(p.jsx)("div",{className:"pageNum",id:"pageNum",children:I+1}),Object(p.jsx)("div",{className:"page",id:"page",children:Object(p.jsx)(_.a,{fontSize:"large",sx:{color:g.length<=(I+1)*b?"#ffffff":"#404040"},onClick:function(){g.length>(I+1)*b&&w(I+1)}})})]})]})},U=n(31),H=n(210),q=n(235),z=Object(v.a)(A||(A=Object(u.a)(["\n    query FindUser($_id: String!){\n        user (query: {_id:$_id}) {\n            _id\n            name\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),F=Object(v.a)(P||(P=Object(u.a)(["\n    query findLogs($user_id: String!){\n        rentLogs (query: {user_id: $user_id}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            user_id\n        }\n    }"]))),M=new q(H.privateKey),K={LoggedOut:0,LoggingIn:1,LoggedIn:2};var Q=function(e){var t=Object(o.useState)(""),n=Object(l.a)(t,2),r=n[0],i=n[1],s=Object(o.useState)(""),u=Object(l.a)(s,2),b=u[0],j=u[1],O=Object(o.useState)([]),g=Object(l.a)(O,2),x=g[0],m=g[1],v=Object(o.useState)(!1),k=Object(l.a)(v,2),S=k[0],C=k[1],E=Object(o.useState)(""),_=Object(l.a)(E,2),I=_[0],w=_[1],D=Object(o.useState)(K.LoggedOut),N=Object(l.a)(D,2),T=N[0],R=N[1],L=Object(o.useState)([]),A=Object(l.a)(L,2),P=A[0],B=A[1],H=Object(y.a)(z,{variables:{_id:I}}),q=Object(l.a)(H,2),Q=q[0],V=q[1].data,Y=Object(y.a)(F,{variables:{user_id:I}}),W=Object(l.a)(Y,2),G=W[0],Z=W[1].data;function J(){return X.apply(this,arguments)}function X(){return X=Object(a.a)(Object(c.a)().mark((function t(){var n,a,o,r=arguments;return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!(r.length>0&&void 0!==r[0])||r[0],console.log("All data loaded "+S),!e.doc.logged){t.next=11;break}return R(K.LoggedIn),a=e.doc.userInfo._id,w(a),m(e.doc.getRent(a)),t.next=9,G();case 9:t.next=14;break;case 11:R(K.LoggedOut),w(""),j("");case 14:n&&((o=h).type=d.c.TYPE.SUCCESS,o.render=e.text.succeededToOpen,o.autoClose=3e3,o.toastId="",d.c.info(e.text.succeededToOpen,o)),console.log("Done"),C(!0);case 17:case"end":return t.stop()}}),t)}))),X.apply(this,arguments)}Object(o.useEffect)((function(){function t(){return(t=Object(a.a)(Object(c.a)().mark((function t(){return Object(c.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?J(!1):e.doc.setCallback(J),console.log("======================================="),console.log("CheckOut initialize");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(o.useEffect)((function(){console.log("User data updated "),J(!1)}),[e.logged]),Object(o.useEffect)((function(){console.log("User data updated "),te()}),[V]),Object(o.useEffect)((function(){var t=[];if(Z){console.log("History updated ");for(var n=0;n<Z.rentLogs.length;n++){var c=Z.rentLogs[n];if("0"===c.book_state||"1"===c.book_state){var a=c.book_id,o=c.timestamp.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:a,title:e.doc.book[a].title,date:o,state:c.book_state})}}t.sort((function(e,t){return e.date>t.date}));for(var r=[],i=0;i<t.length-1;i++)if("1"===t[i].state)for(var s=t[i],l=s.id,u=i+1;u<t.length;u++)if("0"===t[u].state&&l===t[u].id){r.push({id:s.id,title:s.title,rentDate:s.date,retDate:t[u].date});break}console.log("Set history"),B(r)}}),[Z]);var $=function(t){return Object(p.jsx)("div",{children:Object(p.jsx)("table",{children:Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{id:"id",children:e.text.id}),Object(p.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(p.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,a=e.retDate,o=e.title;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("tr",{className:"bookData",children:[Object(p.jsx)("td",{className:"bookData",children:Object(p.jsx)(U.b,{to:"/search/"+n,children:n})}),Object(p.jsx)("td",{className:"bookData",children:c}),Object(p.jsx)("td",{className:"bookData",children:a})]},t),Object(p.jsx)("tr",{className:"bookName",children:Object(p.jsx)("td",{colSpan:"3",className:"bookName",children:o})},t.toString()+"Title")]})}(e,t)})),0===t.length&&Object(p.jsx)("tr",{children:Object(p.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},ee=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R(K.LoggingIn),w(r.toUpperCase()),e.next=4,Q();case 4:return e.next=6,G();case 6:console.log("Log In"),te();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function te(){if(V&&T!==K.LoggedOut){var t=!1;if(V.user&&b.length>0){console.log("User data available");var n=V.user.encrypted_email,c=V.user.encrypted_phone;if(n===M.sign(b,"base64"))t=!0;else{for(var a="",o=0;o<b.length;o++)isNaN(b[o])||(a+=b[o]);M.sign(a,"base64")===c&&(t=!0)}}console.log(d.c.isActive(f));var r,i=h;t?(e.doc.logIn(V.user),m(e.doc.getRent(I)),R(K.LoggedIn),i.type=d.c.TYPE.SUCCESS,r=e.text.logInSucceed):(i.type=d.c.TYPE.ERROR,r=e.text.logInFail),i.render=r,i.autoClose=3e3,i.toastId=f,d.c.isActive(f)?(console.log("update toast"),d.c.update(f,i)):(console.log("New toast"),d.c.info(r,i))}}return Object(p.jsxs)("div",{id:"checkOut",children:[Object(p.jsx)("div",{id:"title",children:Object(p.jsxs)("h2",{children:[e.logged&&e.text.checkOutTitle,!e.logged&&e.text.logIn]})}),Object(p.jsxs)("div",{id:"checkOutInput",hidden:T===K.LoggedIn,children:[Object(p.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:r,disabled:!S,onInput:function(e){i(e.target.value)}}),Object(p.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:b,disabled:!S,onInput:function(e){j(e.target.value)}}),Object(p.jsxs)("button",{id:"logIn",onClick:Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ee());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(p.jsxs)("div",{id:"checkOutResult",hidden:T!==K.LoggedIn,children:[Object(p.jsx)("div",{children:$(x)}),Object(p.jsx)("div",{id:"name",children:e.text.history}),Object(p.jsx)("div",{children:$(P)})]})]})},V=(n(356),n(13)),Y=n(14),W=function(){function e(){Object(V.a)(this,e),console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.logCallback=void 0}return Object(Y.a)(e,[{key:"checkState",value:function(){this.bookReady&&this.rentReady&&(this.initialized=!0,this.callback&&(d.c.dismiss(),this.callback()))}},{key:"setLogCallback",value:function(e){this.logCallback=e}},{key:"setRent",value:function(e){this.rent=e,this.rentReady=!0,this.checkState()}},{key:"setBook",value:function(e){this.book={};for(var t=0;t<e.length;t++){var n=e[t],c=n._id;this.book[c]=n}this.bookReady=!0,this.checkState()}},{key:"logIn",value:function(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,this.logCallback&&this.logCallback(!0)}},{key:"logOut",value:function(){console.log("Logged out"),this.logged=!1,this.userInfo={},this.logCallback&&this.logCallback(!1)}},{key:"getRent",value:function(e){var t=[];console.log("Check "+e);for(var n=0;n<this.rent.length;n++){var c=this.rent[n];if(c.user_id===e){var a=c.book_id,o=this.book[a],r={};r.id=o._id,r.title=o.title,r.rentDate=c.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),r.retDate=c.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),t.push(r)}}return t}},{key:"openDoc",value:function(){var e=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.initialized=!0,e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.initialized}},{key:"setCallback",value:function(e){console.log("Update function registered"),this.callback=e}}]),e}(),G=W,Z=n(143),J=n(211);n(359),n(360);var X=function(e){var t=Object(o.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1],r=Object(o.useState)(!1),i=Object(l.a)(r,2),s=i[0],u=i[1];return Object(o.useEffect)((function(){c!==e.dropdown&&(console.log("User clicked"),console.log(e.dropdown),u(!s),a(e.dropdown))}),[e.dropdown,c,s]),Object(p.jsxs)("div",{onClick:function(){u(!s)},className:s?"dropdown-menu":"drop-menu",children:[Object(p.jsx)(U.b,{className:"menu-items",to:"/",onClick:function(){return u(!1)},children:e.text.home}),e.logged&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(p.jsx)(U.b,{className:"menu-items",to:"/notice",onClick:function(){return u(!1)},children:e.text.notice}),Object(p.jsx)(U.b,{className:"menu-items",to:"/search",onClick:function(){return u(!1)},children:e.text.searchTitle}),Object(p.jsx)(U.b,{className:"menu-items",to:"/checkOut",onClick:function(){return u(!1)},children:e.text.checkOutTitle}),Object(p.jsx)("div",{className:"menu-items",onClick:function(){return u(!1),void e.doc.logOut()},children:e.text.logOut})]}),!e.logged&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(U.b,{className:"menu-items",to:"/notice",onClick:function(){return u(!1)},children:e.text.notice}),Object(p.jsx)(U.b,{className:"menu-items",to:"/checkOut",onClick:function(){return u(!1)},children:e.text.logIn}),Object(p.jsx)(U.b,{className:"menu-items",to:"/search",onClick:function(){return u(!1)},children:e.text.searchTitle})]})]})},$=n(212),ee=n.n($);var te,ne,ce=function(e){var t=Object(o.useState)(!1),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(p.jsx)("div",{className:"title",children:J.isMobile?Object(p.jsx)("h1",{children:e.text.titleShort}):Object(p.jsx)("h1",{children:e.text.titleLong})}),Object(p.jsx)("div",{className:"menu",onClick:function(){var e=document.getElementById("navbar").style.maxWidth;console.log("maxWidth"),console.log(e),console.log(document.getElementById("navbar").style.width),a(!c)},children:Object(p.jsx)(ee.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(p.jsx)(X,{text:e.text,doc:e.doc,logged:e.logged,dropdown:c})]})})},ae=Object(v.a)(te||(te=Object(u.a)(["\n    query AllBook{\n        books (sortBy: TITLE_ASC, limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n        }\n    }\n"]))),oe=Object(v.a)(ne||(ne=Object(u.a)(["\n    query AllRent{\n        rents (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            state\n        }\n    }\n"]))),re=new G,ie={},se="";var le=function(){var e=Object(o.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],i=Object(k.b)(oe),s=i.loading,u=i.error,b=i.data,j=Object(k.b)(ae),f=j.loading,g=j.error,x=j.data;function v(e){console.log("==== Update logging state"),console.log(re.userInfo),r(re.logged)}return Object(o.useEffect)((function(){console.log("Rent Query Updated"),se=se+"<p>Rent Query Updated "+s+" "+u+"</p>",console.log(s),console.log(u),b&&(console.log("Rent available"),se+="<p>Rent available</p>",re.setRent(b.rents))}),[s,u,b]),Object(o.useEffect)((function(){console.log("Book Query Updated"),se+="<p>Book Query Updated</p>",console.log(f),console.log(g),x&&(console.log("Book available"),se+="<p>Book available</p>",re.setBook(x.books))}),[f,g,x]),Object(o.useEffect)((function(){function e(){return(e=Object(a.a)(Object(c.a)().mark((function e(){var t,n,a,o;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in console.log("Initialize app"),se+="<p>Initialize app</p>",console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/hkmcclib",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.5.1"}).APP_NAME),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/hkmcclib",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_NAME:"library",REACT_APP_VERSION:"0.5.1"}).APP_VERSION),t=navigator.languages,console.log(t),n={},n=t.length>0&&(t[0].toLowerCase().includes("kr")||t[0].toLowerCase().includes("ko"))?Z.kr:Z.en)ie[a]=n[a];(o=h).type=d.c.TYPE.LOADING,o.autoClose=!1,o.toastId=O,d.c.loading(ie.loading,o),re.setLogCallback(v);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(p.jsx)(U.a,{children:Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(ce,{doc:re,text:ie,logged:n}),Object(p.jsxs)(R.c,{children:[Object(p.jsx)(R.a,{path:"/",element:Object(p.jsx)(m,{doc:re,text:ie})}),Object(p.jsx)(R.a,{path:"/notice",element:Object(p.jsx)(D,{doc:re,text:ie})}),Object(p.jsx)(R.a,{path:"/search/:id?",element:Object(p.jsx)(B,{doc:re,text:ie})}),Object(p.jsx)(R.a,{path:"/checkOut",element:Object(p.jsx)(Q,{doc:re,text:ie,logged:n})})]}),Object(p.jsx)("div",{children:Object(p.jsx)(d.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:d.b,limit:2})}),Object(p.jsxs)("h3",{children:["v ","0.5.1"]})]})})},ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,387)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),c(e),a(e),o(e),r(e)}))},de=n(144),be=n(384),je=n(383),he=n(385),Oe=n(382),fe="data-xaque",pe="https://realm.mongodb.com/api/client/v2.0/app/".concat(fe,"/graphql"),ge=new de.a(fe);function xe(){return me.apply(this,arguments)}function me(){return(me=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ge.currentUser){e.next=5;break}return e.next=3,ge.logIn(de.b.anonymous());case 3:e.next=7;break;case 5:return e.next=7,ge.currentUser.refreshAccessToken();case 7:return e.abrupt("return",ge.currentUser.accessToken);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ve=new be.a({link:new je.a({uri:pe,fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(a.a)(Object(c.a)().mark((function e(t,n){var a;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe();case 2:return a=e.sent,n.headers.Authorization="Bearer ".concat(a),e.abrupt("return",fetch(t,n));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),cache:new he.a});s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(Oe.a,{client:ve,children:Object(p.jsx)(le,{})})}),document.getElementById("root")),ue()}},[[362,1,2]]]);
//# sourceMappingURL=main.b1eaddf1.chunk.js.map