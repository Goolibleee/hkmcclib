(this.webpackJsonplibrary=this.webpackJsonplibrary||[]).push([[1],{178:function(e){e.exports=JSON.parse('{"en":{"titleLong":"Holy Korean Martyrs Catholic Church Library","titleShort":"HKMCC Library","idHolder":"Enter User ID","pwHolder":"Enter email or phone","bookHolder":"Enter book ID","logIn":"Log In","logOut":"Log Out","logInSucceed":"Logged in","logInFail":"Log In Failed","nameSuffix":"","home":"Home","checkOutStatus":"Check Out Status","bookSearch":"Book Search","userSearch":"User Search","checkOut":"Check Out","return":"Return","extend":"Extend","history":"Rent History","situation":"Rent State","loading":"Loading DB","succeededToOpen":"Succeeded to load","searchUser":"Enter name or ID","searchBook":"Enter book keywords","failedToOpen":"Failed to open DB Refresh page later","all":"All","available":"Available","checkedOut":"Checked out","reserved":"Reserved","overDue":"Overdue","lost":"Lost","damaged":"Damanged","given":"Given","notAvailable":"Not available","deleted":"Deleted","id":"ID","bookName":"Book name","rentDate":"Rent date","returnDate":"Return date","dueDate":"Due date","noEntry":"No entry","notice":"Notice","newMember":"New Member","autoLogin":"AutoLogin","userMode":"User Mode","adminMode":"Admin Mode","normal":"Normal","stopped":"Stopped","homeText":"<div class=\\"container\\"><h2>Library Hours:</h2> <ul> <li>Every Sunday 9:30am~12:00pm</li> </ul> <h2>Book Borrowing:</h2> <ul> <li>Every Sunday 10:30am~12:00pm</li> <li>Maximum number of books for borrowing: 5</li> <li>Borrowing period: 3 weeks (Please request an extension from a volunteer at the time of borrowing or send an extension request email to <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>)</li> <li>Book return: Please return the books to the return box in front of the library or directly to the library volunteers.</li> <li>Request for desired books: Please fill out and submit the desired book request form provided at the library.</li> </ul> <h2>For other inquiries:</h2> <ul> <li>Please contact the library by email at <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>.</li> </ul></div>","INVALID_BOOK":"Unregistered book","INVALID_USER":"Invalid user","NOT_AVAILABLE":"Not available","OVERDUE":"Overdue account","RENTED":"Already rented book","MAX_RENTAL":"Max rent reached","NOT_RENTED":"Not a rented book","rentSucceed":"Rented","returnSucceed":"Returned","rentSuffix":" book(s) rented","confirmRent":"Rent this book?","confirmReturn":"Return this book?","confirm":"Confirm","cancel":"Cancel","name":"Name","registeredDate":"Registered","phone":"Phone","email":"Email","address":"Address","notice_":"Notice","level":"Level","save":"Save","confirmSave":"Save the modification?","kid":"Kid","adult":"Adult","admin":"Admin","regSuccess":"Registration Succeed","regFail":"Registration Fail","numberOnly":"Number Only","advSearch":"Advanced Search","search":"Search","author":"Author","bookCode":"Book code","finish":"Finish","extending":"Extend requested","maxExtend":"Max Extended"},"kr":{"titleLong":"\ucc9c\uc8fc\uad50 \uc0b0\ud638\uc138 \ud55c\uad6d \uc21c\uad50\uc790 \uc131\ub2f9 \ub3c4\uc11c\uad00","titleShort":"HKMCC \ub3c4\uc11c\uad00","idHolder":"\ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","pwHolder":"\uc774\uba54\uc77c\uc774\ub098 \uc804\ud654\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","bookHolder":"\ub3c4\uc11c \ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","logIn":"\ub85c\uadf8\uc778","logOut":"\ub85c\uadf8\uc544\uc6c3","logInSucceed":"\ub85c\uadf8\uc778 \uc131\uacf5","logInFail":"\ub85c\uadf8\uc778 \uc2e4\ud328","nameSuffix":" \ub2d8","home":"\ud648","checkOutStatus":"\ub300\ucd9c \uae30\ub85d \uc870\ud68c","bookSearch":"\ub3c4\uc11c \uac80\uc0c9","userSearch":"\ud68c\uc6d0 \uac80\uc0c9","checkOut":"\ub300\ucd9c","return":"\ubc18\ub0a9","extend":"\ub300\ucd9c \uc5f0\uc7a5","history":"\ub300\ucd9c \uc774\ub825","situation":"\ub300\ucd9c \ud604\ud669","loading":"DB \uc870\ud68c \uc911","succeededToOpen":"DB \uc870\ud68c \uc644\ub8cc","searchUser":"\uc774\ub984 \ub610\ub294 \ud68c\uc6d0\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694","searchBook":"\ucc45 \ud0a4\uc6cc\ub4dc\ub97c \uc785\ub825\ud558\uc138\uc694","failedToOpen":"DB \uc870\ud68c\uac00 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4 \uc7a0\uc2dc \ud6c4 \ud654\uba74\uc744 \uac31\uc2e0\ud574\uc8fc\uc138\uc694","all":"\uc804\uccb4","available":"\ub300\ucd9c\uac00\ub2a5","checkedOut":"\ub300\ucd9c\uc911","reserved":"\uc608\uc57d\uc911","overDue":"\uc5f0\uccb4\uc911","lost":"\ubd84\uc2e4","damaged":"\ud30c\uc190","given":"\uae30\uc99d","notAvailable":"\ub300\ucd9c\ubd88\uac00","deleted":"\ud3d0\uae30","id":"\ubc88\ud638","bookName":"\ub3c4\uc11c\uba85","rentDate":"\ub300\ucd9c\uc77c","returnDate":"\ubc18\ub0a9\uc77c","dueDate":"\ub300\ucd9c\uae30\ud55c","noEntry":"\ub0b4\uc5ed \uc5c6\uc74c","notice":"\uacf5\uc9c0 \uc0ac\ud56d","newMember":"\uc2e0\uaddc \ud68c\uc6d0","autoLogin":"\uc790\ub3d9 \ub85c\uadf8\uc778","userMode":"\uc77c\ubc18 \ubaa8\ub4dc","adminMode":"\uad00\ub9ac\uc790 \ubaa8\ub4dc","normal":"\uc815\uc0c1","stopped":"\ub300\ucd9c\uc911\uc9c0","homeText":"<div class=\\"container\\"><h2>\ub3c4\uc11c\uad00 \uac1c\ubc29\uc2dc\uac04:</h2><ul><li>\ub9e4 \uc8fc\uc77c(\uc77c) 9:30am~12:00pm</li></ul><h2>\ub3c4\uc11c \ub300\ucd9c:</h2><ul><li>\ub9e4 \uc8fc\uc77c 10:30am~12:00pm </li><li>\ub300\ucd9c \uad8c\uc218: \ucd5c\ub300 5\uad8c</li><li>\ub300\ucd9c \uae30\uac04: 3\uc8fc (\ub3c4\uc11c \ub300\ucd9c\uc2dc\uac04\uc5d0 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc5f0\uc7a5\uc744 \uc694\uccad\ud558\uc2dc\uac70\ub098, <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\uc73c\ub85c \uc5f0\uc7a5 \uc2e0\uccad \uba54\uc77c\uc744 \ubcf4\ub0b4\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)</li><li>\ub3c4\uc11c \ubc18\ub0a9: \ub3c4\uc11c\uad00 \uc55e \ubc18\ub0a9\ud568\uc5d0 \ub123\uc5b4 \uc8fc\uc2dc\uac70\ub098 \ub3c4\uc11c\uad00 \ubd09\uc0ac\uc790\uc5d0\uac8c \uc9c1\uc811 \ubc18\ub0a9\ud558\uc5ec \uc8fc\uc2ed\uc2dc\uc624.</li><li>\ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad: \ub3c4\uc11c\uad00\uc5d0 \ube44\uce58\ub41c \ud76c\ub9dd \ub3c4\uc11c \uc2e0\uccad\uc11c\uc5d0 \uc791\uc131\ud558\uc5ec \uc81c\ucd9c\ud558\uc5ec \uc8fc\uc138\uc694.</li></ul></p><h2>\ubb38\uc758:</h2><ul><li>\ub3c4\uc11c\uad00 \uad00\ub828 \ubb38\uc758\ub294 \ub3c4\uc11c\uad00 \uc774\uba54\uc77c \uc8fc\uc18c <a href=\'mailto:hkmcc.library@gmail.com\'>hkmcc.library@gmail.com</a>\ub85c \ubb38\uc758 \ubc14\ub78d\ub2c8\ub2e4.</li></ul></div>","INVALID_BOOK":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","INVALID_USER":"\ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \ud68c\uc6d0\uc785\ub2c8\ub2e4","NOT_AVAILABLE":"\ub300\ucd9c \ubd88\uac00 \ub3c4\uc11c\uc785\ub2c8\ub2e4","OVERDUE":"\uc5f0\uccb4\uc911\uc785\ub2c8\ub2e4","RENTED":"\ub300\ucd9c\ub41c \ub3c4\uc11c\uc785\ub2c8\ub2e4","MAX_RENTAL":"\ub300\ucd9c \uad8c\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4","NOT_RENTED":"\ub300\ucd9c\ub418\uc9c0 \uc54a\uc740 \ub3c4\uc11c\uc785\ub2c8\ub2e4","rentSucceed":"\ub300\ucd9c \uc644\ub8cc","returnSucceed":"\ubc18\ub0a9 \uc644\ub8cc","rentSuffix":"\uad8c \ub300\ucd9c \uc911","confirmRent":"\ub300\ucd9c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirmReturn":"\ubc18\ub0a9\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","confirm":"\ud655\uc778","cancel":"\ucde8\uc18c","name":"\uc774\ub984","registeredDate":"\ub4f1\ub85d\uc77c","phone":"\uc804\ud654\ubc88\ud638","email":"\uc774\uba54\uc77c","address":"\uc8fc\uc18c","notice_":"\ube44\uace0","level":"\ub4f1\uae09","save":"\uc800\uc7a5","confirmSave":"\uc800\uc7a5\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?","kid":"\uc544\ub3d9","adult":"\uc131\uc778","admin":"\uad00\ub9ac\uc790","regSuccess":"\ub4f1\ub85d \uc644\ub8cc","regFail":"\ub4f1\ub85d \uc2e4\ud328","numberOnly":"\uc22b\uc790\ub9cc \uc785\ub825\ud558\uc138\uc694","advSearch":"\uc0c1\uc138 \uac80\uc0c9","search":"\uac80\uc0c9","author":"\uc800\uc790","bookCode":"\ub3c4\uc11c\ubc88\ud638","finish":"\uc644\ub8cc","extending":"\uc5f0\uc7a5 \uc2e0\uccad\uc911","maxExtend":"\uc5f0\uc7a5 \ud55c\ub3c4 \ucd08\uacfc"}}')},288:function(e,t,n){},289:function(e,t,n){},290:function(e,t,n){},305:function(e,t,n){},313:function(e,t){},316:function(e,t){},327:function(e,t){},329:function(e,t){},354:function(e,t){},356:function(e,t){},357:function(e,t){},362:function(e,t){},364:function(e,t){},370:function(e,t){},372:function(e,t){},391:function(e,t){},403:function(e,t){},406:function(e,t){},457:function(e,t,n){},458:function(e,t,n){},460:function(e,t,n){"use strict";n.r(t);var c=n(2),o=n.n(c),r=n(260),a=(n(288),n(3)),s=n(7),i=n(4),l=(n(289),n(24)),u=(n(290),n(1));var d=function(e){return Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Home"),e.doc.setCallback(void 0);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),e.doc.serverAvailable?(n.e(0).then(n.t.bind(null,511,7)),Object(u.jsxs)("div",{id:"home",children:[Object(u.jsx)(l.b,{className:"home-items",to:"/checkOut",children:e.text.checkOut}),Object(u.jsx)(l.b,{className:"home-items",to:"/return",children:e.text.return})]})):Object(u.jsx)("div",{id:"home",dangerouslySetInnerHTML:{__html:e.text.homeText}})},b=(n(56),n(80)),j=n(510),h=10,O=500;String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var n=new RegExp("\\{"+t+"\\}","gi");e=e.replace(n,arguments[t])}return e};var f={position:"top-center",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0},x=function(e,t){return"0"===t||0===t?e.normal:"1"===t||1===t?e.overDue:"2"===t||2===t?e.stopped:void 0},p=function(e,t){switch(t){case"0":case 0:return e.available;case"1":case 1:return e.checkedOut;case"2":case 2:return e.reserved;case"3":case 3:return e.overDue;case"4":case 4:return e.lost;case"5":case 5:return e.damaged;case"6":case 6:return e.given;case"7":case 7:default:return e.notAvailable;case"8":case 8:return e.deleted}},g=function(e,t){if(e.name>t.name)return 1;if(e.name<t.name)return-1;var n=parseInt(e.claim_num),c=parseInt(t.claim_num);return n>c?1:n<c?-1:0},m=function(e,t){return e.name>t.name?1:e.name<t.name?-1:0},v=function(e,t){return e.rentDate>t.rentDate?1:e.rentDate<t.rentDate?-1:e.title>t.title?1:e.title<t.title?-1:0},k=function(e){return unescape(encodeURIComponent(e))},S="custom-loading-id",E="custom-logging-id",y=n(10),N=n(128),I=n.n(N),C=n(130),A=n.n(C);var _=function(){console.log("Do nothing...")};var R,w,D,T,L,U,B,P,M,q,H,K=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),o=n[0],r=n[1],a=Object(c.useState)(0),s=Object(i.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)([]),j=Object(i.a)(b,2),O=j[0],f=j[1];return Object(c.useEffect)((function(){console.log("Init List View")}),[]),Object(c.useEffect)((function(){r(e.list)}),[e.list]),Object(c.useEffect)((function(){d(0)}),[e.keyValue]),Object(c.useEffect)((function(){e.showCallback&&(_=e.showCallback)}),[e.showCallback]),Object(c.useEffect)((function(){var e=o.length;if(e>h){var t=l*h,n=Math.min(h,e-t);f(o.slice(t,t+n))}else f(o)}),[o,l]),Object(u.jsxs)("div",{id:"listView",children:[_(O,e.detail),o&&o.length>h&&Object(u.jsxs)("div",{id:"pageControl",children:[Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(I.a,{fontSize:"large",sx:{color:0===l?"#ffffff":"#404040"},onClick:function(){console.log("Prev"),l>0&&d(l-1)}})}),Object(u.jsx)("div",{className:"pageNum",id:"pageNum",children:l+1}),Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(A.a,{fontSize:"large",sx:{color:o.length<=(l+1)*h?"#ffffff":"#404040"},onClick:function(){console.log("Next"),o.length>(l+1)*h&&d(l+1)}})})]})]})},V=n(47),z=n(48),Y=(Object(z.a)(R||(R=Object(V.a)(["\n    query AllBook{\n        book (limit:20000) {\n            _id\n            author\n            title\n            claim_num\n            num\n            series\n            category\n            claim\n            publisher\n            seqnum\n            registration_date\n            isbn\n            deleted\n        }\n    }\n"]))),Object(z.a)(w||(w=Object(V.a)(["\n    query AllRent{\n        rent (limit:20000) {\n            _id\n            book_id\n            user_id\n            rent_date\n            return_date\n            extend_count\n            state\n        }\n    }\n"])))),F=Object(z.a)(D||(D=Object(V.a)(["\n    query AllUser {\n        user (limit: 20000) {\n            _id\n            name\n            state\n            level\n        }\n    }"]))),W=Object(z.a)(T||(T=Object(V.a)(["\n    query FindUser($_id: string){\n        user (where: {_id: {_eq: $_id}}) {\n            _id\n            name\n            state\n            level\n            encrypted_email\n            encrypted_phone\n        }\n    }"]))),G=Object(z.a)(L||(L=Object(V.a)(["\n    query findLogs($user_id: string){\n        rentLog (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),Q=Object(z.a)(U||(U=Object(V.a)(["\n    query findLogs($book_id: string){\n        rentLog (limit: 20000, where: {book_id: {_eq: $book_id}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),Z=Object(z.a)(B||(B=Object(V.a)(["\n    query findLogs ($fromTime: string, $toTime: string) {\n        rentLog(limit: 20000, where: {timestamp: {_gte: $fromTime, _lt: $toTime}}) {\n            _id\n            book_id\n            book_state\n            timestamp\n            return_date\n            user_id\n        }\n    }"]))),J=Object(z.a)(P||(P=Object(V.a)(["\n    query GetNotices {\n        notice (order_by: {date: asc}, limit:20000) {\n            _id\n            date\n            title\n        }\n    }"]))),X=Object(z.a)(M||(M=Object(V.a)(["\n    query GetContent ($_id: string) {\n        notice (where: {_id: {_eq: $_id}}) {\n            _id\n            date\n            title\n            content\n        }\n    }"]))),$=Object(z.a)(q||(q=Object(V.a)(["\n    query GetServerInfo {\n        serverInfo {\n            _id\n            globalIp\n            localIp\n            port\n            proxy\n        }\n    }"]))),ee=Object(z.a)(H||(H=Object(V.a)(["\n    query GetRequests($user_id: string) {\n        request (limit: 20000, where: {user_id: {_eq: $user_id}}) {\n            _id\n            user_id\n            action\n            state\n            book_id\n        }\n    }"])));var te=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),o=n[0],r=n[1],d=Object(c.useState)([]),O=Object(i.a)(d,2),f=O[0],x=O[1],p=Object(c.useState)(0),g=Object(i.a)(p,2),m=g[0],v=g[1],k=Object(b.e)(J),S=k.loading,E=k.data,N=k.error,I=Object(y.r)().id,C=Object(j.a)(X,{variables:{_id:I}}),A=Object(i.a)(C,2),_=A[0],R=A[1],w=R.loading,D=R.data,T=R.error;Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Notice"),e.doc.setCallback(void 0);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){console.log("Get Notice"),E&&r(E.notice)}),[E,N,S]),Object(c.useEffect)((function(){console.log("Get Content")}),[D,T,w]),Object(c.useEffect)((function(){var e=o.length;if(console.log("Page num "+m.toString()+" "),console.log(e),e>h){var t=m*h,n=Math.min(h,e-t);x(o.slice(t,t+n))}else x(o),v(0)}),[o,m]),Object(c.useEffect)((function(){}),[f]),Object(c.useEffect)((function(){console.log("Select id: "+I),I&&_()}),[I,_]);var L=function(e){return Object(u.jsxs)("tr",{className:"",children:[Object(u.jsxs)("td",{className:"",children:[" ",e.date," "]}),Object(u.jsxs)("td",{className:"noticeEntry",colSpan:"2",children:[I!==e._id&&Object(u.jsx)(l.b,{to:"/notice/"+e._id,children:e.title}),I===e._id&&Object(u.jsx)(l.b,{to:"/notice",children:e.title})]})]},e._id)};return Object(u.jsxs)("div",{id:"notice",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.notice})}),I&&D&&Object(u.jsx)("div",{id:"noticeContent",children:Object(u.jsx)("table",{className:"content",children:Object(u.jsxs)("tbody",{children:[L(D.notice[0]),Object(u.jsx)("tr",{children:Object(u.jsx)("td",{className:"content",colSpan:"3",children:D.notice[0].content})})]})})}),Object(u.jsx)(K,{list:o,showCallback:function(e){return Object(u.jsx)("div",{id:"noticeList",children:Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:f.length>0&&f.map((function(e){return L(e)}))})})})}})]})},ne=n(28),ce=n(53),oe=n(275),re=(n(304),!1);var ae=function(e){var t=Object(c.useState)(""),o=Object(i.a)(t,2),r=o[0],d=o[1],b=Object(c.useState)([]),h=Object(i.a)(b,2),f=h[0],x=h[1],m=Object(c.useState)(0),v=Object(i.a)(m,2),S=v[0],E=v[1],N=Object(c.useState)([]),I=Object(i.a)(N,2),C=I[0],A=I[1],_=Object(c.useState)([]),R=Object(i.a)(_,2),w=R[0],D=R[1],T=Object(c.useState)(0),L=Object(i.a)(T,2),U=L[0],B=L[1],P=Object(c.useState)(!1),M=Object(i.a)(P,2),q=M[0],H=M[1],V=Object(c.useState)(!1),z=Object(i.a)(V,2),Y=z[0],F=z[1],W=Object(c.useState)(""),G=Object(i.a)(W,2),Z=G[0],J=G[1],X=Object(c.useState)(!1),$=Object(i.a)(X,2),ee=$[0],te=$[1],ae=Object(c.useState)(""),se=Object(i.a)(ae,2),ie=se[0],le=se[1],ue=Object(c.useState)(""),de=Object(i.a)(ue,2),be=de[0],je=de[1],he=Object(c.useState)(""),Oe=Object(i.a)(he,2),fe=Oe[0],xe=Oe[1],pe=Object(c.useState)(""),ge=Object(i.a)(pe,2),me=ge[0],ve=ge[1],ke=Object(c.useState)(""),Se=Object(i.a)(ke,2),Ee=Se[0],ye=Se[1],Ne=Object(c.useState)(0),Ie=Object(i.a)(Ne,2),Ce=Ie[0],Ae=Ie[1],_e=Object(c.useState)([]),Re=Object(i.a)(_e,2),we=Re[0],De=Re[1],Te=Object(ce.a)(r,300),Le=Object(i.a)(Te,1)[0],Ue=Object(j.a)(Q,{variables:{book_id:Z}}),Be=Object(i.a)(Ue,2),Pe=Be[0],Me=Be[1].data,qe=Object(c.useRef)("0"),He=Object(c.useRef)(!1),Ke=Object(c.useRef)(0),Ve=Object(c.useRef)(!1),ze=Object(y.r)().id;function Ye(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s,i,l,u,d;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log("All data loaded "+re),re=!0,n=[],c={},o=e.doc.rent,r=0;r<o.length;r++)n.push({code:o[r].book_id,retDate:o[r].return_date,state:o[r].state}),c[o[r].book_id]=o[r].state;for(l in D(n),s=[],i=e.doc.book)u=i[l],d=l in c?c[l]:0,s.push({code:u._id,name:u.title,state:d,num:u.num,author:u.author,claim:u.claim,regDate:u.registration_date,claim_num:u.claim_num,totalName:u.series,category:u.publisher,publish:u.publisher,isbn:u.isbn,deleted:u.deleted});console.log("Load"),console.log(s.length),A(s),console.log(Z),""!==Z&&(console.log("Load history"),Pe());case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.isOpen()?Ye():e.doc.setCallback(Ye),e.doc.serverAvailable&&n.e(0).then(n.t.bind(null,511,7)),console.log("BOOK ID: "+ze);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){console.log("Updated id: "+ze),ze?(console.log("Set Book ID "+ze),J(ze),Pe()):J("")}),[ze,Pe]),Object(c.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(s.a)(Object(a.a)().mark((function t(n){var c,o,r,s,i,l,u,d,b,j,h;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=[],!e.doc.serverAvailable){t.next=18;break}return console.log(k(n)),console.log(btoa(k(n))),o="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",console.log("======================="),console.log("Request book list"),r={book:btoa(k(n)),match:!1},t.next=10,e.doc.requestGet(o,r);case 10:if(s=t.sent,console.log(s),"books"in s.data.return){t.next=14;break}return t.abrupt("return",c);case 14:for(i=s.data.return.books,l=0;l<i.length;l++)u=i[l],d="".concat(u.BOOKNAME," ").concat(u.CLAIMNUM),b=u._STATE,j="",1!==b&&3!==b&&"1"!==b&&"3"!==b||(j=e.text.returnDate+" "+u._RETURN),h={index:l,text:d,name:u.BOOKNAME,code:u.BARCODE,rent:p(e.text,u._STATE.toString()),retDate:j,regDate:u.REG_DATE,author:u.AUTHOR,totalName:u.TOTAL_NAME,claim_num:u.CLAIMNUM,publish:u.PUBLISH,claim:u.CLAIM,state:u._STATE,isbn:u.ISBN},c.push(h);t.next=19;break;case 18:c=$e(n,C);case 19:return c.sort(g),t.abrupt("return",c);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function c(){return(c=Object(s.a)(Object(a.a)().mark((function e(){var n,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Refresh"),!ee){e.next=3;break}return e.abrupt("return");case 3:if(n=""!==Z?Z:Le,console.log(n),!n){e.next=13;break}return e.next=8,t(n);case 8:(c=e.sent).length>0?x(c):x([]),1===c.length&&(qe.current=c[0].code),e.next=14;break;case 13:x([]);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[Le,Z,C,w,e,Y,ee]),Object(c.useEffect)((function(){if(console.log("History update"),console.log(Me),!Me)return De([]),void(Ve.current=!1);for(var e=[],t=0;t<Me.rentLog.length;t++){var n=Me.rentLog[t];if(1===n.book_state){var c=[n.timestamp];c.push(n.return_date),e.push(c)}}console.log(e.length),De(e),Ve.current=e.length>0}),[Me]);var We=function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Prev "+qe.current),1===f.length||-1===qe.current||qe.current!==t?(console.log("Select "+t),E(t),qe.current=t):(console.log("Deselect "+t),E(-1),qe.current=-1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Ge(e){console.log("Set state "+U+" to "+e.toString()),He.current=!0,H(!0),B(e),Ke.current=e,console.log(S.toString()+He.current)}function Qe(e){var t=e.toString(),n=document.getElementById(t).checked;console.log("Set Search state "+t+" Value: "+n),"1023"===t?(document.getElementById("1023").checked=n,document.getElementById("0").checked=n,document.getElementById("1").checked=n,document.getElementById("3").checked=n,document.getElementById("4").checked=n,document.getElementById("5").checked=n,document.getElementById("6").checked=n,document.getElementById("7").checked=n,document.getElementById("8").checked=n):document.getElementById(t).checked=n;for(var c=0,o=0;o<9;o++){var r=o.toString(),a=document.getElementById(r);a&&(c|=a.checked?1<<o:0)}Ae(c),console.log("Filter: "+c.toString())}function Ze(){return(Ze=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Confirmed"),He.current=!1,H(!1),n=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port,!(0===n.length||c<=0)){t.next=7;break}return t.abrupt("return");case 7:return o="https://"+n+":"+c+"/book",(r={}).book=qe.current,r.state=Ke.current,console.log("======================="),console.log("Change book state"),t.next=15,e.doc.requestPost(o,r);case 15:F(!Y);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Je=function(t,n){var c=t.code!==qe.current,o=c?"searchResult":"selectedSearchResult",r=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];r[t.state]=!0,1!==t.state&&2!==t.state&&3!==t.state||(r[0]=!0);var i=n[2];return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{id:o,onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We(t.code);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),children:Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsxs)("tr",{className:"searchTr",children:[Object(u.jsx)("td",{className:"searchTitle",children:t.text}),Object(u.jsx)("td",{className:"searchRent",children:t.rent})]})})})}),!c&&Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[t.author," "]}),Object(u.jsxs)("td",{colSpan:"2",rowSpan:"2",children:[t.totalName+" ",Object(u.jsx)("b",{children:t.name})," "+t.claim_num]})]},"row1"),Object(u.jsx)("tr",{children:Object(u.jsx)("td",{children:Object(u.jsx)(l.b,{to:"/search/"+t.code,children:t.code})})},"row2"),Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:t.publish}),Object(u.jsx)("td",{colSpan:t.retDate.length>0?"1":"2",children:t.claim}),t.retDate.length>0&&Object(u.jsx)("td",{children:t.retDate})]},"row3")]})}),Object(u.jsx)("table",{className:"rentHistory",hidden:!Ve.current,children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{id:"titles",children:[Object(u.jsx)("td",{children:e.text.rentDate}),Object(u.jsx)("td",{children:e.text.returnDate})]}),i.map((function(e){return function(e){return Object(u.jsxs)("tr",{children:[Object(u.jsx)("td",{children:e[0]},e[0]+"x"),Object(u.jsx)("td",{children:e[1]})]},e[0])}(e)}))]})}),Object(u.jsxs)("div",{hidden:!e.doc.serverAvailable||!e.doc.admin,children:[Object(u.jsxs)("button",{className:"bookStates",id:"0",disabled:r[0],onClick:function(){return Ge(0)},children:[" ",e.text.available," "]}),Object(u.jsxs)("button",{className:"bookStates",id:"4",disabled:r[4],onClick:function(){return Ge(4)},children:[" ",e.text.lost," "]}),Object(u.jsxs)("button",{className:"bookStates",id:"5",disabled:r[5],onClick:function(){return Ge(5)},children:[" ",e.text.damaged," "]}),Object(u.jsxs)("button",{className:"bookStates",id:"6",disabled:r[6],onClick:function(){return Ge(6)},children:[" ",e.text.given," "]}),Object(u.jsxs)("button",{className:"bookStates",id:"7",disabled:r[7],onClick:function(){return Ge(7)},children:[" ",e.text.notAvailable," "]}),Object(u.jsxs)("button",{className:"bookStates",id:"8",disabled:r[8],onClick:function(){return Ge(8)},children:[" ",e.text.deleted," "]})]}),Object(u.jsxs)("div",{id:"checkRent",hidden:!He.current,children:[Object(u.jsxs)("div",{id:"bookName",children:[" ",p(e.text,Ke.current)," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){return Ze.apply(this,arguments)}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){return console.log("Cancelled"),He.current=!1,void H(!1)},children:[" ",e.text.cancel," "]})]})]})]},t.code)};function Xe(e,t){e?je(t):xe(t)}function $e(t,n){var c=[];console.log(ee);var o=t.toLowerCase();console.log(o);for(var r=0;r<n.length;r++){var a=n[r];if(c.length>=O)break;if((!(o.length>0)||a.name&&a.name.toString().toLowerCase().includes(o)||a.totalName&&a.totalName.toString().toLowerCase().includes(o)||a.author&&a.author.toString().toLowerCase().includes(o)||a.code.toLowerCase()===o||a.isbn===o)&&(!a.deleted||"Y"!==a.deleted)){if(ee){if(ie.length>0&&a.author&&!a.author.toString().toLowerCase().includes(ie.toLowerCase()))continue;if(be.length>0&&a.code<be)continue;if(fe.length>0&&a.code>fe)continue;var s=a.regDate;if(s<me||s>Ee)continue;if(console.log(a),console.log(s),console.log(s<me),console.log(s>Ee),!(1<<a.state&Ce))continue}else if(0===o.length)continue;var i,l="".concat(a.name," ").concat(a.claim_num),u="",d="0",b=Object(ne.a)(w);try{for(b.s();!(i=b.n()).done;){var j=i.value;if(j.code===a.code){"1"!==(d=j.state)&&"3"!==d||(u=e.text.returnDate+" "+j.retDate);break}}}catch(f){b.e(f)}finally{b.f()}var h={index:r,text:l,name:a.name,code:a.code.toString(),rent:p(e.text,d),retDate:u,regDate:a.regDate,author:a.author,totalName:a.totalName,claim_num:a.claim_num,publish:a.publish,claim:a.claim,state:parseInt(d),isbn:a.isbn};c.push(h)}}return console.log(c.length),c}return Object(u.jsxs)("div",{id:"search",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsxs)("h2",{children:[" ",e.text.bookSearch," "]})}),Object(u.jsxs)("div",{id:"searchContents",hidden:""!==Z,children:[Object(u.jsx)("input",{id:"searchInput",placeholder:e.text.searchBook,value:r,onChange:function(e){d(e.target.value)}}),Object(u.jsxs)("div",{hidden:!e.doc.admin,children:[Object(u.jsx)("input",{type:"checkbox",id:"advancedSearch",checked:ee,onChange:function(){te(!ee)}}),Object(u.jsx)("label",{children:e.text.advSearch})]}),Object(u.jsxs)("div",{hidden:!ee,children:[Object(u.jsxs)("div",{children:[Object(u.jsxs)("label",{children:[" ",e.text.author," "]}),Object(u.jsx)("input",{type:"text",id:"author",onChange:function(e){le(e.target.value)}})]}),Object(u.jsxs)("div",{children:[Object(u.jsxs)("label",{children:[" ",e.text.bookCode," "]}),Object(u.jsx)("input",{type:"text",id:"fromPeriod",onChange:function(e){Xe(!0,e.target.value)}}),Object(u.jsx)("label",{children:" ~  "}),Object(u.jsx)("input",{type:"text",id:"toPeriod",onChange:function(e){Xe(!1,e.target.value)}})]}),Object(u.jsxs)("div",{children:[Object(u.jsxs)("label",{children:[" ",e.text.registeredDate," "]}),Object(u.jsx)(oe.a,{onChange:function(e){console.log(e);var t=e[0],n=e[1],c=t.getFullYear().toString()+"-"+(t.getMonth()+1).toString().padStart(2,"0")+"-"+t.getDate().toString().padStart(2,"0");console.log(c),ve(c);var o=n.getFullYear().toString()+"-"+(n.getMonth()+1).toString().padStart(2,"0")+"-"+n.getDate().toString().padStart(2,"0");console.log(o),ye(o)},selectRange:!0})]}),Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"stateName",children:e.text.all}),Object(u.jsx)("td",{className:"stateName",children:e.text.available}),Object(u.jsx)("td",{className:"stateName",children:e.text.checkedOut}),Object(u.jsx)("td",{className:"stateName",children:e.text.overDue}),Object(u.jsx)("td",{className:"stateName",children:e.text.lost}),Object(u.jsx)("td",{className:"stateName",children:e.text.damaged}),Object(u.jsx)("td",{className:"stateName",children:e.text.given}),Object(u.jsx)("td",{className:"stateName",children:e.text.notAvailable}),Object(u.jsx)("td",{className:"stateName",children:e.text.deleted})]},"stateName"),Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"1023",onChange:function(){return Qe(1023)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"0",onChange:function(){return Qe(0)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"1",onChange:function(){return Qe(1)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"3",onChange:function(){return Qe(3)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"4",onChange:function(){return Qe(4)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"5",onChange:function(){return Qe(5)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"6",onChange:function(){return Qe(6)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"7",onChange:function(){return Qe(7)}})}),Object(u.jsx)("td",{className:"stateButton",children:Object(u.jsx)("input",{type:"checkbox",className:"bookStates",id:"8",onChange:function(){return Qe(8)}})})]},"stateButton")]})})}),Object(u.jsx)("div",{children:Object(u.jsxs)("button",{id:"searchEntry",onClick:function(){console.log("Search"),console.log(be),console.log(fe),console.log(me),console.log(Ee);var e=$e(r,C);e.sort(g);var t=e;t.length>0?x(t):x([]),1===t.length&&(qe.current=t[0].code)},children:[" ",e.text.search," "]})})]})]}),Object(u.jsx)(K,{keyValue:Le,list:f,detail:[S,q,we],showCallback:function(e,t){return function(e,t){return console.log("Redraw "+He.current),console.log(Ve.current),console.log(t),e.map((function(e){return Je(e,t)}))}(e,t)}})]})},se=n(19),ie={LoggedOut:0,LoggingIn:1,LoggedIn:2},le=1;var ue=function(e){var t=Object(c.useState)(""),r=Object(i.a)(t,2),d=r[0],b=r[1],h=Object(c.useState)(""),O=Object(i.a)(h,2),x=O[0],p=O[1],g=Object(c.useState)([]),m=Object(i.a)(g,2),k=m[0],S=m[1],N=Object(c.useState)(!1),I=Object(i.a)(N,2),C=I[0],A=I[1],_=Object(c.useState)(""),R=Object(i.a)(_,2),w=R[0],D=R[1],T=Object(c.useState)(ie.LoggedOut),L=Object(i.a)(T,2),U=L[0],B=L[1],P=Object(c.useState)([]),M=Object(i.a)(P,2),q=M[0],H=M[1],V=Object(c.useState)(0),z=Object(i.a)(V,2),Y=z[0],F=z[1],Q=Object(c.useState)(!1),Z=Object(i.a)(Q,2),J=Z[0],X=Z[1],$=Object(j.a)(W,{variables:{_id:w}}),te=Object(i.a)($,2),ne=te[0],ce=te[1].data,oe=Object(j.a)(G,{variables:{user_id:w}}),re=Object(i.a)(oe,2),ae=re[0],ue=re[1].data,de=Object(j.a)(ee,{variables:{user_id:w}}),be=Object(i.a)(de,2),je=be[0],he=be[1].data,Oe=Object(c.useState)(""),fe=Object(i.a)(Oe,2),xe=fe[0],pe=fe[1],ge=Object(c.useState)(""),me=Object(i.a)(ge,2),ve=me[0],ke=me[1];function Se(){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(s.a)(Object(a.a)().mark((function t(){var n;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("All data loaded "+C),!e.doc.logged){t.next=17;break}return B(ie.LoggedIn),n=e.doc.userInfo._id,D(n),t.t0=S,t.next=8,e.doc.getRent(n);case 8:return t.t1=t.sent,(0,t.t0)(t.t1),console.log(e.doc.getRent(n)),t.next=13,ae();case 13:return t.next=15,je();case 15:t.next=20;break;case 17:B(ie.LoggedOut),D(""),p("");case 20:console.log("Set title "+e.doc.logged),e.doc.logged?e.doc.adminMode?ke(e.text.userSearch):ke(e.text.checkOut):ke(e.text.logIn),console.log("Done"),A(!0);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var c,o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized){t.next=2;break}return t.abrupt("return");case 2:e.doc.isOpen()&&Se(),console.log("======================================="),console.log("CheckOutStatus initialize"),e.doc.serverAvailable&&n.e(0).then(n.t.bind(null,511,7)),"autoLogin"in e.context.cookie&&(c="true"===e.context.cookie.autoLogin,X(c)),o=new Date,2,o.setTime(o.getTime()+1728e5),pe(o.toGMTString());case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){console.log("User data updated "),Se()}),[e.doc.logged]),Object(c.useEffect)((function(){function e(){return(e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("User data updated "),e.next=3,Ce();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[ce]),Object(c.useEffect)((function(){if(ue&&e.doc.bookReady&&e.doc.rentReady){console.log("History updated ");for(var t=[],n=ue.rentLog,c=0;c<n.length;c++){var o=n[c];if(("1"===o.book_state||1===o.book_state)&&("return_date"in o&&o.return_date)){var r=o.book_id;if(r in e.doc.book){var a=e.doc.book[r],s=a.title,i=a.claim,l=o.timestamp.split(" ")[0].replace("-","/",2).replace("-","/"),u=o.return_date.split(" ")[0].replace("-","/",2).replace("-","/");t.push({id:r,title:s,rentDate:l,retDate:u,claim:i,totalName:a.series,claim_num:a.claim_num})}}}t.sort(v),console.log("Set history"),H(t)}}),[ue,e.doc.bookReady,e.doc.rentReady]),Object(c.useEffect)((function(){console.log("Request data"),he&&(console.log("Request available"),e.doc.setRequest(he.request))}),[he]);var ye=function(t,n){var c;return c=n?e.text.returnDate:e.text.dueDate,Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:c})]},"ID"),t.map((function(t,c){return function(t,n,c){var r,i,d=t.id,b=t.rentDate,j=t.retDate,h=t.claim,O=n.toString(),f=t.extendCount,x=f>=le;return c?r="1":(i=e.doc.hasRequest(d),r="2"),Object(u.jsxs)(o.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"bookData",children:Object(u.jsx)(l.b,{to:"/search/"+d,children:d})}),Object(u.jsx)("td",{className:"bookData",children:b}),Object(u.jsx)("td",{className:"bookData",children:j})]},O),Object(u.jsxs)("tr",{className:"bookName",children:[Object(u.jsx)("td",{className:"bookName",children:h}),Object(u.jsxs)("td",{colSpan:"2",rowSpan:r,className:"bookName",children:[t.totalName+" ",Object(u.jsx)("b",{children:t.title})," "+t.claim_num]})]},O+"Title"),!c&&Object(u.jsx)("tr",{className:"bookExtend",children:Object(u.jsxs)("td",{className:"bookExtend",children:[" ",Object(u.jsxs)("button",{id:"extend",onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ie(d));case 1:case"end":return e.stop()}}),e)}))),disabled:i||x,children:[x&&e.text.maxExtend,i&&!x&&e.text.extending,!(i||x)&&e.text.extend,"(",f,")"]})]})},O+"Extend")]},O+"Fragment")}(t,c,n)})),0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})},Ne=function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(ie.LoggingIn),D(d.toUpperCase()),e.next=4,ne();case 4:return e.next=6,ae();case 6:return e.next=8,je();case 8:return console.log("Log In"),e.next=11,Ce();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var t=Object(s.a)(Object(a.a)().mark((function t(n){var c,o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Extend"),c=(new Date).toISOString().replace("T"," ").replace("Z",""),console.log(c),o='{\n "user_id": "'+w+'",\n "book_id": "'+n+'",\n "date": "'+c+'",\n "action": "extend"\n}\n',e.context.sendRequest(o),e.doc.addRequest(n),F(Y+1);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ce=function(){var t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ce&&U!==ie.LoggedOut){t.next=2;break}return t.abrupt("return");case 2:if(console.log(se.c.isActive(E)),n=f,console.log(x),o=ce.user[0],!e.context.checkLogIn(o,x)){t.next=19;break}return e.doc.logIn(o),t.t0=S,t.next=11,e.doc.getRent(w);case 11:t.t1=t.sent,(0,t.t0)(t.t1),B(ie.LoggedIn),n.type=se.c.TYPE.SUCCESS,c=e.text.logInSucceed,document.cookie="user_id="+w+"; expires="+xe+";",t.next=21;break;case 19:n.type=se.c.TYPE.ERROR,c=e.text.logInFail;case 21:n.render=c,n.autoClose=3e3,n.toastId=E,se.c.isActive(E)?(console.log("update toast"),se.c.update(E,n)):(console.log("New toast"),se.c.info(c,n));case 25:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:ve})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:!(U!==ie.LoggedIn),children:[Object(u.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:d,disabled:!C,onInput:function(e){b(e.target.value)}}),Object(u.jsx)("input",{type:"password",id:"searchPassword",placeholder:e.text.pwHolder,value:x,disabled:!C,onInput:function(e){p(e.target.value)}}),Object(u.jsxs)("div",{id:"autoLogin",children:[Object(u.jsx)("input",{type:"checkbox",id:"autoLoginButton",checked:J,onChange:function(){return function(){console.log("Toggle autoLogin");var e="autoLogin="+(J?"false":"true")+"; expires="+xe+";";document.cookie=e,X(!J)}()}}),Object(u.jsx)("label",{children:e.text.autoLogin})]}),Object(u.jsxs)("button",{id:"logIn",onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ne());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(u.jsxs)("div",{id:"checkOutResult",hidden:!(U===ie.LoggedIn),children:[Object(u.jsx)("div",{children:ye(k,!1)}),Object(u.jsx)("div",{id:"name",children:e.text.history}),Object(u.jsx)(K,{list:q,showCallback:function(e){return ye(e,!0)}})]})]}):Object(u.jsx)(y.a,{to:"/"})},de={LoggedOut:0,LoggingIn:1,LoggedIn:2,LoggingOut:3};var be=function(e){var t=Object(c.useState)(""),o=Object(i.a)(t,2),r=o[0],l=o[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),j=b[0],h=b[1],O=Object(ce.a)(j,500),p=Object(i.a)(O,1)[0],g=Object(c.useState)(""),m=Object(i.a)(g,2),v=m[0],k=m[1],N=Object(c.useState)(!1),I=Object(i.a)(N,2),C=I[0],A=I[1],_=Object(c.useState)(""),R=Object(i.a)(_,2),w=R[0],D=R[1],T=Object(c.useState)({}),L=Object(i.a)(T,2),U=L[0],B=L[1],P=Object(c.useState)([]),M=Object(i.a)(P,2),q=M[0],H=M[1],V=Object(c.useState)({}),z=Object(i.a)(V,2),Y=z[0],F=z[1],W=Object(c.useState)({}),G=Object(i.a)(W,2),Q=G[0],Z=G[1],J=Object(c.useState)(de.LoggedOut),X=Object(i.a)(J,2),$=X[0],ee=X[1],te=Object(y.r)().id,ne=Object(y.p)();Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(console.log("======================================="),console.log("CheckOut initialize"),t=document.getElementsByName("idPrefix"),n=0;n<t.length;n++)c=t[n].id,t[n].checked="AB"===c;console.log("ID: "+te),te&&0!==te.length&&(l(te),re(te));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var c=setInterval(Object(s.a)(Object(a.a)().mark((function t(){var c,o,r,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("localIp"in e.doc.serverInfo&&"port"in e.doc.serverInfo){t.next=2;break}return t.abrupt("return");case 2:if(!e.doc.admin){t.next=4;break}return t.abrupt("return");case 4:if(n.e(0).then(n.t.bind(null,511,7)),c=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port,!(c.length>0&&o>0)){t.next=14;break}return r="https://"+c+":"+o+"/scanBarcode",t.next=11,e.doc.requestGet(r,{});case 11:s=t.sent,(i=s.data.scan)&&(console.log(i),console.log($),D(i));case 14:case"end":return t.stop()}}),t)}))),1e3);return function(){t.apply(this,arguments)}(),function(){return clearInterval(c)}}),[]),Object(c.useEffect)((function(){console.log("Updated id: "+te)}),[te]),Object(c.useEffect)((function(){w&&(console.log("Updated barcode: "+w),console.log("state : "+$),$===de.LoggedIn?k(w):$===de.LoggedOut&&re(w))}),[w]),Object(c.useEffect)((function(){console.log("User data updated "),console.log(se.c.isActive(E));var t,n=f,c=!1;"USER_CODE"in Y&&$!==de.LoggedIn?(console.log("Set state to LoggedIn from "+$),ee(de.LoggedIn),n.type=se.c.TYPE.SUCCESS,t=e.text.logInSucceed,c=!0):"USER_CODE"in Y||(console.log("Set state to LoggedOut from "+$),$===de.LoggingIn&&(n.type=se.c.TYPE.ERROR,t=e.text.logInFail,c=!0),ee(de.LoggedOut)),c&&B({id:S,text:t,type:n.type})}),[Y]),Object(c.useEffect)((function(){console.log("book updated "),"BARCODE"in Q?0===Q._STATE?A(!0):(B({id:S,text:e.text.RENTED,type:se.c.TYPE.ERROR}),A(!1)):(A(!1),k(""))}),[Q]),Object(c.useEffect)((function(){if("text"in U){se.c.dismiss(),console.log("Notification "+U.text);var e=f;e.type=U.type,e.autoClose=3e3,se.c.info(U.text,e)}}),[U]);var oe=function(){var t=Object(s.a)(Object(a.a)().mark((function t(n){var c,o,r,s;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/user?user="+n,o={user:n,data:"nothing"},t.next=4,e.doc.requestGet(c,o);case 4:r=t.sent,s=r.data.return,F(s),console.log(s),l(s.USER_CODE);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),re=function(){var e=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c,o,r,s,i,l,u=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:void 0,c="",r=document.getElementsByName("idPrefix"),!t){e.next=21;break}if(!(t.length<=2)){e.next=6;break}return e.abrupt("return");case 6:c=t.substring(0,2),s=!1,o=0;case 9:if(!(o<r.length)){e.next=16;break}if(c!==r[o].id){e.next=13;break}return s=!0,e.abrupt("break",16);case 13:o++,e.next=9;break;case 16:if(s){e.next=18;break}return e.abrupt("return");case 18:n=t,e.next=24;break;case 21:for(i=document.getElementById("userInput").value,o=0;o<r.length;o++)r[o].checked&&(c=r[o].id),console.log("Pressed ["+o.toString()+" "+c+"]");n="A"===i[0]||"a"===i[0]?i:c+i;case 24:if(console.log("LOGIN"),console.log(n),0!==n.length){e.next=28;break}return e.abrupt("return");case 28:console.log("Set state to LoggingIn from "+$),ee(de.LoggingIn),l=n.toUpperCase(),oe(l);case 32:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Finish"),F({}),Z({}),l(""),k(""),H([]),ne("/");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function ie(){return le.apply(this,arguments)}function le(){return(le=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Confirmed"),A(!1),console.log(Q),n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/checkOut",c={book:Q.BARCODE,user:r},t.next=7,e.doc.requestPost(n,c);case 7:o=t.sent,s=o.data.return,console.log("Rent confirmed"),console.log(s),"SUCCESS"===s?(B({id:S,text:e.text.rentSucceed,type:se.c.TYPE.SUCCESS}),q.push({id:Q.BARCODE,name:Q.BOOKNAME}),console.log(q),H(q)):(i=s in e.text?e.text[s]:e.text.NOT_AVAILABLE,console.log(i),B({id:S,text:i,type:se.c.TYPE.ERROR})),Z({}),k(""),oe(r);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ue(t){return Object(u.jsxs)("div",{id:"bookList",children:[Object(u.jsxs)("div",{id:"dueDate",children:[e.text.dueDate," : ",e.doc.dueDate]}),t.map((function(e,t){return function(e,t){return Object(u.jsxs)("div",{id:"bookEntry",children:[Object(u.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(u.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)}))]})}return Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(p.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return n=e.doc.admin?p:"HK"+p,console.log("Search book1 "+n),c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={book:n,match:!0},t.next=8,e.doc.requestGet(c,o);case 8:r=t.sent,s=r.data.return,console.log(s),"books"in s&&"BOOKNAME"in s.books&&(console.log(s.books),Z(s.books));case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[p,e.doc]),Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Set bookId: "+v),0!==v.length){t.next=3;break}return t.abrupt("return");case 3:return console.log("Search book2 "+v),n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={book:v,match:!0},t.next=8,e.doc.requestGet(n,c);case 8:o=t.sent,r=o.data.return,console.log(r),"books"in r&&"BOOKNAME"in r.books&&Z(r.books);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[v,e.doc]),Object(c.useEffect)((function(){function e(){return(e=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Set userId: "+r),r&&0!==r.length){e.next=3;break}return e.abrupt("return");case 3:if(0===r.search("AA")||0===r.search("AB"))for(t=document.getElementsByName("idPrefix"),n=r.substring(0,2),c=0;c<t.length;c++)o=t[c].id,t[c].checked=n===o;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[r]),Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.checkOut})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:$===de.LoggedIn,children:[Object(u.jsx)("input",{type:"radio",id:"AA",name:"idPrefix"}),Object(u.jsx)("label",{htmlFor:"AA",className:"idPrefix",name:"idPrefix",children:" AA "}),Object(u.jsx)("input",{type:"radio",id:"AB",name:"idPrefix"}),Object(u.jsx)("label",{htmlFor:"AB",className:"idPrefix",name:"idPrefix",children:" AB "}),Object(u.jsx)("input",{type:"text",id:"userInput",pattern:"[0-9]*",inputMode:"numeric",placeholder:e.text.idHolder,onKeyDown:function(e){!function(e){"Enter"===e.key&&(console.log(e),console.log(document.getElementById("userInput").value),re())}(e)}}),Object(u.jsxs)("button",{id:"logIn",onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",re());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.logIn," "]})]}),Object(u.jsxs)("div",{id:"checkOutResult",hidden:$!==de.LoggedIn,children:[Y.USER_CODE&&Object(u.jsxs)("div",{id:"userInfo",children:[Object(u.jsx)("div",{id:"userItem",children:Y.USER_CODE+" : "+Y.USER_NAME+e.text.nameSuffix}),Object(u.jsxs)("div",{id:"userItem",children:[" ",x(e.text,Y.USER_STATE)," "]}),Object(u.jsxs)("div",{id:"userItem",children:[" ",Y._RENT.length+" "+e.text.rentSuffix," "]})]}),Object(u.jsx)("div",{id:"bookInput",hidden:C,children:Object(u.jsxs)("label",{id:"manualInput",children:[Object(u.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(u.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",type:"text",id:"bookInput",placeholder:e.text.bookHolder,onInput:function(e){h(e.target.value)}})]})}),Object(u.jsxs)("div",{id:"checkRent",hidden:!C,children:[Object(u.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmRent," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",Q.AUTHOR+":"," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",Q.BOOKNAME," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie());case 1:case"end":return e.stop()}}),e)}))),children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){return console.log("Cancelled"),A(!1),Z({}),void k("")},children:[" ",e.text.cancel," "]})]}),q.length>0&&Object(u.jsx)(K,{list:q,showCallback:function(e){return ue(e)}})]}),Object(u.jsxs)("button",{id:"logOutButton",onClick:function(){return ae()},children:[" ",e.text.finish," "]})]})},je=n(265),he=n.n(je);var Oe=function(e){var t=Object(c.useState)(""),o=Object(i.a)(t,2),r=o[0],l=o[1],d=Object(ce.a)(r,300),b=Object(i.a)(d,1)[0],j=Object(c.useState)({}),h=Object(i.a)(j,2),O=h[0],x=h[1],p=Object(c.useState)(!1),g=Object(i.a)(p,2),m=g[0],v=g[1],k=Object(c.useState)({}),E=Object(i.a)(k,2),N=E[0],I=E[1],C=Object(c.useState)(""),A=Object(i.a)(C,2),_=A[0],R=A[1],w=Object(c.useState)([]),D=Object(i.a)(w,2),T=D[0],L=D[1],U=Object(y.p)();function B(){return(B=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Confirmed"),v(!1),console.log(O),n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/return",c={book:O.BARCODE},t.next=7,e.doc.requestPost(n,c);case 7:o=t.sent,r=o.data.return,console.log(r),"SUCCESS"===r?(I({id:S,text:e.text.returnSucceed,type:se.c.TYPE.SUCCESS}),T.push({id:O.BARCODE,name:O.BOOKNAME}),console.log(T),L(T)):(s=r in e.text?e.text[r]:e.text.NOT_AVAILABLE,console.log(s),I({id:S,text:s,type:se.c.TYPE.ERROR})),x({}),R("");case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function P(e){return Object(u.jsx)("div",{id:"bookList",children:e.map((function(e,t){return function(e,t){return Object(u.jsxs)("div",{id:"bookEntry",children:[Object(u.jsxs)("div",{id:"bookItem",children:[" ",t.id," "]}),Object(u.jsxs)("div",{id:"bookItem",children:[" ",t.name," "]})]},t.id)}(0,e)}))})}Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.doc.setCallback(void 0),console.log("======================================="),console.log("Return initialize");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var c=setInterval(Object(s.a)(Object(a.a)().mark((function t(){var c,o,r,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("localIp"in e.doc.serverInfo&&"port"in e.doc.serverInfo){t.next=2;break}return t.abrupt("return");case 2:if(!e.doc.admin){t.next=4;break}return t.abrupt("return");case 4:if(n.e(0).then(n.t.bind(null,511,7)),c=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port,!(c&&c.length>0&&o>0)){t.next=14;break}return r="https://"+c+":"+o+"/scanBarcode",t.next=11,e.doc.requestGet(r,{});case 11:s=t.sent,(i=s.data.scan)&&(console.log(i.search("HK")),0===i.search("HK")&&(console.log(_+" -> "+i),R(i)));case 14:case"end":return t.stop()}}),t)}))),1e3);return function(){t.apply(this,arguments)}(),function(){return clearInterval(c)}}),[]),Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,s,i;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r.length>0)){t.next=10;break}return n=e.doc.admin?r:"HK"+r,console.log("Search book1 "+n),c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={book:n,match:!0},t.next=7,e.doc.requestGet(c,o);case 7:s=t.sent,"books"in(i=s.data.return)&&"BOOKNAME"in i.books&&x(i.books);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[b,e.doc,r]),Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("B"+_),!(_.length>0)){t.next=12;break}return n=_,console.log("Search book2 "+n),c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={book:n,match:!0},t.next=8,e.doc.requestGet(c,o);case 8:r=t.sent,s=r.data.return,console.log(s),"books"in s&&"BOOKNAME"in s.books&&x(s.books);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[_,e.doc]),Object(c.useEffect)((function(){console.log("book updated "),"BARCODE"in O?1===O._STATE||3===O._STATE?v(!0):(console.log("Not rented"),I({id:S,text:e.text.NOT_RENTED,type:se.c.TYPE.ERROR}),document.getElementById("barcodeScan").value=null,v(!1),R("")):v(!1)}),[O]),Object(c.useEffect)((function(){if("text"in N){se.c.dismiss();var e=f;e.type=N.type,e.autoClose=3e3,se.c.info(N.text,e)}}),[N]),Object(c.useEffect)((function(){if(console.log("Returned updated"),console.log(T),"localIp"in e.doc.serverInfo&&"port"in e.doc.serverInfo){console.log("Update return list");var t="HK"+r;console.log("Search book1 "+t);var n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",c={books:T};e.doc.requestGet(n,c)}}),[T,r,e.doc]);var M=function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Finish"),U("/");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.return})}),Object(u.jsxs)("div",{id:"checkOutResult",children:[Object(u.jsxs)("div",{id:"bookInput",hidden:m,children:[Object(u.jsxs)("label",{id:"barcodeScan",hidden:!0,children:[Object(u.jsx)(he.a,{fontSize:"large",sx:{color:"#404040"}}),Object(u.jsx)("span",{})]}),Object(u.jsxs)("label",{id:"manualInput",children:[Object(u.jsx)("div",{id:"hkPrefix",children:e.text.numberOnly}),Object(u.jsx)("input",{inputMode:"numeric",pattern:"\\d*",type:"text",id:"searchInput",placeholder:e.text.bookHolder,onInput:function(e){l(e.target.value)}})]})]}),Object(u.jsxs)("div",{id:"checkReturn",hidden:!m,children:[Object(u.jsxs)("div",{id:"bookName",children:[" ",e.text.confirmReturn," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",O.AUTHOR+":"," "]}),Object(u.jsxs)("div",{id:"bookName",children:[" ",O.BOOKNAME," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){return B.apply(this,arguments)}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){return console.log("Cancelled"),v(!1),x({}),void R("")},children:[" ",e.text.cancel," "]})]}),T.length>0&&Object(u.jsx)(K,{list:T,showCallback:function(e){return P(e)}})]}),Object(u.jsxs)("button",{id:"logOutButton",onClick:function(){return M()},children:[" ",e.text.finish," "]})]})};n(305);var fe=function(e){var t=Object(c.useState)(!1),n=Object(i.a)(t,2),o=n[0],r=n[1],l=Object(c.useState)(!0),d=Object(i.a)(l,2),b=d[0],j=d[1],h=Object(c.useState)({}),O=Object(i.a)(h,2),f=O[0],x=O[1];function p(e,t){console.log(e),console.log(t);var n=f;switch(e){case 0:n.USER_NAME=t;break;case 1:n.PHONE_NUMBER=t;break;case 2:n.EMAIL=t;break;case 3:n.ADDRESS=t;break;case 4:n.USER_LEVEL=t;break;case 5:n.NOTICE=t}var c=Object.keys(n).length;console.log(c),c>1&&j(!1),x(n)}function g(){return(g=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,s,i,l;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Save modification"),console.log(f),n=e.doc.serverInfo.localIp,c=e.doc.serverInfo.port,!(0===n.length||c<=0)){t.next=6;break}return t.abrupt("return");case 6:for(i in o="https://"+n+":"+c+"/user",s={},console.log(f),f)s[i]=btoa(k(f[i]));return t.next=12,e.doc.requestPost(o,s);case 12:l=t.sent,console.log(l),e.refresh(l),r(!1);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(c.useEffect)((function(){console.log("User Info"),console.log(e.info),document.getElementById("userName").value=e.info.USER_NAME?e.info.USER_NAME:"",document.getElementById("phone").value=e.info.PHONE_NUMBER?e.info.PHONE_NUMBER:"",document.getElementById("email").value=e.info.EMAIL?e.info.EMAIL:"",document.getElementById("address").value=e.info.ADDRESS?e.info.ADDRESS:"",document.getElementById("notice_").value=e.info.NOTICE?e.info.NOTICE:"",document.getElementById("user_level").value=e.info.USER_LEVEL,x({USER_CODE:e.info.USER_CODE}),j(!0)}),[e.info]),Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.name," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"userName",onChange:function(e){p(0,e.target.value)}})})]},"Name"),"REG_DATE"in e.info&&Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.registeredDate," "]}),Object(u.jsx)("td",{colSpan:"3",className:"data",children:e.info.REG_DATE})]},"Register"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.phone," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"phone",onChange:function(e){p(1,e.target.value)}})})]},"Phone"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.email," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"email",onChange:function(e){p(2,e.target.value)}})})]},"Email"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.address," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"address",onChange:function(e){p(3,e.target.value)}})})]},"Address"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.notice_," "]}),Object(u.jsx)("td",{colSpan:"3",children:Object(u.jsx)("input",{type:"text",className:"input",id:"notice_",onChange:function(e){p(5,e.target.value)}})})]},"Notice"),Object(u.jsxs)("tr",{children:[Object(u.jsxs)("td",{children:[" ",e.text.level," "]}),Object(u.jsx)("td",{colSpan:"3",className:"cell",children:Object(u.jsxs)("select",{name:"User Level",id:"user_level",className:"dropdown",onChange:function(e){p(4,e.target.value)},children:[Object(u.jsxs)("option",{value:"0",children:[" ",e.text.kid," "]}),Object(u.jsxs)("option",{value:"1",children:[" ",e.text.adult," "]}),Object(u.jsxs)("option",{value:"2",children:[" ",e.text.admin," "]})]})})]},"Level")]})}),Object(u.jsxs)("button",{id:"modify",hidden:o,onClick:Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r(!0));case 1:case"end":return e.stop()}}),e)}))),disabled:b,children:[" ",e.text.save," "]}),Object(u.jsxs)("div",{id:"checkModify",hidden:!o,children:[Object(u.jsxs)("div",{id:"noticeMsg",children:[" ",e.text.confirmSave," "]}),Object(u.jsxs)("button",{id:"confirm",onClick:function(){return function(){return g.apply(this,arguments)}()},children:[" ",e.text.confirm," "]}),Object(u.jsxs)("button",{id:"cancel",onClick:function(){r(!1)},children:[" ",e.text.cancel," "]})]})]})};var xe=function(e){var t=Object(c.useState)(""),r=Object(i.a)(t,2),d=r[0],b=r[1],h=Object(ce.a)(d,300),p=Object(i.a)(h,1)[0],g=Object(c.useState)(!1),v=Object(i.a)(g,2),S=v[0],E=v[1],N=Object(c.useState)([]),I=Object(i.a)(N,2),C=I[0],A=I[1],_=Object(c.useState)(!1),R=Object(i.a)(_,2),w=R[0],D=R[1],T=Object(j.a)(F),L=Object(i.a)(T,2),U=L[0],B=L[1],P=B.loading,M=B.data,q=B.error,H=Object(c.useState)({}),V=Object(i.a)(H,2),z=V[0],Y=V[1],W=Object(c.useRef)("0"),G=Object(y.r)().id,Q=Object(c.useState)([]),Z=Object(i.a)(Q,2),J=Z[0],X=Z[1],$=Object(y.p)();function ee(){return te.apply(this,arguments)}function te(){return te=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o=arguments;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!(o.length>0&&void 0!==o[0])||o[0],console.log("All data loaded "+w),n&&((c=f).type=se.c.TYPE.SUCCESS,c.render=e.text.succeededToOpen,c.autoClose=3e3,c.toastId="",se.c.info(e.text.succeededToOpen,c)),console.log("Set title "+e.logged),console.log("Done"),D(!0);case 6:case"end":return t.stop()}}),t)}))),te.apply(this,arguments)}function oe(e){console.log("Refresh page "+S),console.log(e),E(!S)}function re(){return(re=Object(s.a)(Object(a.a)().mark((function t(n){var c,o,r,s,i,l;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Extend "+n),c=e.doc.serverInfo.localIp,o=e.doc.serverInfo.port,!(0===c.length||o<=0)){t.next=5;break}return t.abrupt("return");case 5:return r="https://"+c+":"+o+"/extend",(s={}).book=n,t.next=10,e.doc.requestPost(r,s);case 10:i=t.sent,console.log("Extended"),console.log(i),ie(W.current,!0),"SUCCESS"===i.data.return&&((l=f).type=se.c.TYPE.SUCCESS,l.render=e.text.succeededToOpen,l.autoClose=3e3,l.toastId="",se.c.info(e.text.extend,l));case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized){t.next=2;break}return t.abrupt("return");case 2:e.doc.isOpen()?ee(!1):e.doc.setCallback(ee),console.log("======================================="),console.log("UserSearch initialize"),console.log("User ID: "+G),e.doc.serverAvailable?n.e(0).then(n.t.bind(null,511,7)):(console.log("Load users"),U());case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){console.log("Updated id: "+G),b(G||"")}),[G]),Object(c.useEffect)((function(){console.log("User data updated "),ee(!1)}),[e.logged]),Object(c.useEffect)((function(){if(console.log("User list loaded"),console.log(q),console.log(P),M){var t=M.user,n=[];console.log("User list available");for(var c=0;c<t.length;c++){var o=t[c],r={id:o._id,name:o.name,level:o.level,state:x(e.text,o.state)};n.push(r)}console.log(n),e.doc.setUser(n),console.log(e.doc.getUser()),Y(e.doc.getUser())}}),[M,P,q,e]);var ae=function(t,n){var c=t.id,r=t.rentDate,a=t.retDate,s=t.title,i=t.extendCount,d=n.toString();return Object(u.jsxs)(o.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookData",children:[Object(u.jsx)("td",{className:"bookData",children:Object(u.jsx)(l.b,{to:"/search/"+c,children:c})}),Object(u.jsx)("td",{className:"bookData",children:r}),Object(u.jsx)("td",{className:"bookData",children:a})]},d),Object(u.jsxs)("tr",{className:"bookName",children:[Object(u.jsx)("td",{colSpan:e.doc.serverAvailable?"2":"3",className:"bookName",children:s}),e.doc.serverAvailable&&Object(u.jsx)("td",{className:"bookName",children:Object(u.jsx)("button",{className:"extend",onClick:function(){return function(e){return re.apply(this,arguments)}(c)},children:e.text.extend+" ("+i.toString()+")"})})]},d+"Title")]},d+"Fragment")},ie=function(){var t=Object(s.a)(Object(a.a)().mark((function t(n){var c,o,r=arguments;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.length>1&&void 0!==r[1]&&r[1],t.next=3,e.doc.getRent(n);case 3:o=t.sent,console.log(o),-1===W.current||W.current!==n||c?(console.log("Select "+n),W.current=n,console.log("Set Rent List"),console.log(o),X(o)):C.length>1&&(console.log("Deselect "+n),W.current=-1,X([]));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),le=function(t,n){return Object(u.jsxs)("div",{children:[t.map((function(e,t){return function(e,t,n){var c=n.toString();return Object(u.jsxs)("div",{children:[Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsxs)("tr",{className:"searchTr",onClick:Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ie(e.id);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:[Object(u.jsx)("td",{className:"bookData",children:e.id}),Object(u.jsx)("td",{className:"bookData",children:e.name}),Object(u.jsx)("td",{className:"bookData",children:e.state}),Object(u.jsx)("td",{className:"bookData",children:e.rent})]},e.id)})}),e.id===W.current&&ue(e,t)]},c)}(e,n,t)})),0===t.length&&Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")})})]})},ue=function(t,n){return console.log("Detail"),console.log(t),Object(u.jsxs)(u.Fragment,{children:[e.doc.serverAvailable&&Object(u.jsxs)("div",{children:[Object(u.jsx)(fe,{text:e.text,doc:e.doc,info:t,refresh:oe}),Object(u.jsxs)("button",{id:"modify",onClick:function(){return $("/checkOut/"+t.USER_CODE)},children:[" ",e.text.checkOut," "]})]}),Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),n.map((function(e,t){return ae(e,t)})),0===n.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})]})};return Object(c.useEffect)((function(){function t(e){return n.apply(this,arguments)}function n(){return(n=Object(s.a)(Object(a.a)().mark((function e(t){var n,c,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.t0=Object(a.a)().keys(z);case 2:if((e.t1=e.t0()).done){e.next=10;break}if(c=e.t1.value,o=z[c],!(n.length>=O)){e.next=7;break}return e.abrupt("break",10);case 7:(o.name&&o.name.toString().includes(t)||o.id.toLowerCase()===t.toLowerCase())&&n.push(o),e.next=2;break;case 10:return n.sort(m),console.log(n),e.abrupt("return",n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=Object(s.a)(Object(a.a)().mark((function n(){var c,o,r,s,i,l,u,b,j,h;return Object(a.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=d.trim(),console.log("Query "+c+" "+p),!(c.length>0&&p)){n.next=24;break}if(!e.doc.serverAvailable){n.next=16;break}return console.log("from CLIB"),r="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/users",s={user:btoa(k(c))},n.next=9,e.doc.requestGet(r,s);case 9:if(i=n.sent,l=i.data.return.data,console.log(i.data.return),o=[],l){u=Object(ne.a)(i.data.return.data);try{for(u.s();!(b=u.n()).done;)j=b.value,console.log(j),(h=j).id=j.USER_CODE,h.name=j.USER_NAME,h.state=x(e.text,j.USER_STATE),h.rent=j._RENT.length,o.push(h)}catch(a){u.e(a)}finally{u.f()}}n.next=20;break;case 16:return console.log("from DB"),n.next=19,t(p);case 19:o=n.sent;case 20:o.length>0?A(o):A([]),1===o.length?ie(o[0].id):ie(0),n.next=25;break;case 24:A([]);case 25:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[p,e,z,S,d]),e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.userSearch})}),Object(u.jsxs)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:[Object(u.jsx)("input",{type:"text",id:"searchInput",placeholder:e.text.idHolder,value:d,onChange:function(e){b(e.target.value)}}),Object(u.jsx)("div",{children:Object(u.jsx)(K,{keyValue:p,list:C,detail:J,showCallback:function(e,t){return le(e,t)}})})]})]}):Object(u.jsx)(y.a,{to:"/"})};var pe=function(e){var t=Object(c.useState)([]),r=Object(i.a)(t,2),d=r[0],b=r[1],h=Object(c.useState)(!1),O=Object(i.a)(h,2),f=O[0],g=O[1],m=Object(j.a)(F),k=Object(i.a)(m,2),S=k[0],E=k[1],N=E.loading,I=E.data,C=E.error,A=Object(c.useState)({}),_=Object(i.a)(A,2),R=_[0],w=_[1];function D(){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s,i,l,u,d,j,h,O,x,m,k;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("All data loaded "+f),!e.doc.serverAvailable){t.next=14;break}return n=[],c="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/book",o={user:"*",match:!1},t.next=7,e.doc.requestGet(c,o);case 7:for(r=t.sent,s=r.data.return.books,i=0;i<s.length;i++)l=s[i],u="".concat(l.BOOKNAME," ").concat(l.CLAIMNUM),d=l._STATE,j="",1!==d&&3!==d&&"1"!==d&&"3"!==d||(j=l.RETURN_DATE),h={index:i,text:u,title:l.BOOKNAME,id:l.BARCODE,rent:p(e.text,l.STATS.toString()),rentDate:l.LENT_DATE,retDate:j,author:l.AUTHOR,totalName:l.TOTAL_NAME,claim_num:l.CLAMENUM,publish:l.PUBLISH,claim:l.CLAIM,user:l.USER,userName:l.USER_NAME},n.push(h);n.sort(v),b(n),t.next=22;break;case 14:return t.next=16,e.doc.getRent();case 16:for(x in O=t.sent,console.log("Rent"),console.log(O),O.sort(v),O)m=O[x].user,k=void 0,k=R&&m in R?R[m].name:"",O[x].userName=k;b(O);case 22:console.log("Done"),g(!0);case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("======================================="),console.log("RentHistory initialize"),e.doc.serverAvailable?(n.e(0).then(n.t.bind(null,511,7)),D()):(console.log("Load users"),S());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){if(console.log("User list loaded"),console.log(C),console.log(N),I){var t=I.user,n=[];console.log("User list available");for(var c=0;c<t.length;c++){var o=t[c],r={id:o._id,name:o.name,level:o.level,state:x(e.text,o.state)};n.push(r)}e.doc.setUser(n),w(e.doc.getUser())}}),[I,N,C,e.doc,e.text]),Object(c.useEffect)((function(){D()}),[R]);var L=function(t){return Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.dueDate})]},"ID"),t&&t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,r=e.retDate,a=e.user,s=e.userName,i=t.toString(),d=e.claim;return Object(u.jsxs)(o.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookTop",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsx)(l.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookCell",children:c}),Object(u.jsx)("td",{className:"bookCell",children:r})]},i),Object(u.jsxs)("tr",{className:"bookRow",children:[Object(u.jsx)("td",{className:"bookName",children:d}),Object(u.jsxs)("td",{colSpan:"2",className:"bookName",children:[e.totalName+" ",Object(u.jsx)("b",{children:e.title})," "+e.claim_num]})]},i+"Title"),Object(u.jsxs)("tr",{className:"bookBottom",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsxs)(l.b,{to:"/userSearch/"+a,children:[" ",a," "]})}),Object(u.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",s," "]})]},i+"Renter")]},i+"Fragment")}(e,t)})),t&&0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})};return e.doc.initialized?Object(u.jsxs)("div",{id:"situation",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.situation})}),Object(u.jsx)("div",{id:"checkOutResult",children:Object(u.jsx)(K,{keyValue:"",list:d,showCallback:function(e){return L(e)}})})]}):Object(u.jsx)(y.a,{to:"/"})};var ge=function(e){var t=Object(c.useState)([]),r=Object(i.a)(t,2),d=r[0],b=r[1],h=Object(c.useState)(""),O=Object(i.a)(h,2),f=O[0],p=O[1],g=Object(c.useState)(""),m=Object(i.a)(g,2),k=m[0],S=m[1],E=Object(j.a)(F),N=Object(i.a)(E,2),C=N[0],_=N[1],R=_.loading,w=_.data,D=_.error,T=Object(j.a)(Z,{variables:{fromTime:f,toTime:k}}),L=Object(i.a)(T,2),U=L[0],B=L[1],P=B.loading,M=B.data,q=B.error,H=Object(c.useState)({}),V=Object(i.a)(H,2),z=V[0],Y=V[1],W=Object(c.useState)(0),G=Object(i.a)(W,2),Q=G[0],J=G[1],X=Object(c.useState)(0),$=Object(i.a)(X,2),ee=$[0],te=$[1],ne=Object(c.useState)(""),oe=Object(i.a)(ne,2),re=oe[0],ae=oe[1],se=Object(ce.a)(re,300),ie=Object(i.a)(se,1)[0];Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var c,o,r,s,i,l;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("======================================="),console.log("RentHistory initialize"),e.doc.initialized){t.next=4;break}return t.abrupt("return");case 4:for(r=document.getElementById("year"),s=document.getElementById("month"),c=1;c<=12;c++)(o=document.createElement("option")).text=c.toString(),s.add(o,c);for(i=(new Date).getFullYear(),l=(new Date).getMonth()+1,2017,c=2017;c<=i;c++)(o=document.createElement("option")).text=c.toString(),r.add(o,c);console.log(i),console.log(l),J(i),te(l),document.getElementById("year").value=i,document.getElementById("month").value=l,e.doc.serverAvailable?n.e(0).then(n.t.bind(null,511,7)):(console.log("Load users"),C());case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(c.useEffect)((function(){if(console.log("User list loaded"),console.log(D),console.log(R),w){var t=w.user,n=[];console.log("User list available");for(var c=0;c<t.length;c++){var o=t[c],r={id:o._id,name:o.name,level:o.level,state:x(e.text,o.state)};n.push(r)}e.doc.setUser(n),Y(e.doc.getUser())}}),[w,R,D,e.doc,e.text]),Object(c.useEffect)((function(){if(console.log("History update"),M){for(var t=M.rentLog,n=[],c="",o=0;o<t.length;o++){var r=t[o],a=r.book_state;if(("1"===a||1===a)&&(r.return_date&&0!==r.return_date.length)){var s,i,l=r.book_id,u=r.user_id;s=z&&u in z?z[u].name:"",l in e.doc.book?i=e.doc.book[l]:((i={}).author="",i.totalName="",i.claim_num="",i.publish="",i.title="");var d="".concat(i.title," ").concat(i.claim_num);c=r.return_date;var j={index:o,text:d,title:i.title,id:l,rentDate:r.timestamp,retDate:c,author:i.author,totalName:i.series,claim_num:i.claim_num,publish:i.publisher,claim:i.claim,user:u,userName:s};n.push(j)}}n.sort(v),console.log(n),b(n)}}),[M,P,q]);var le=function(t){return Object(u.jsx)("div",{children:Object(u.jsx)("table",{children:Object(u.jsxs)("tbody",{children:[Object(u.jsxs)("tr",{children:[Object(u.jsx)("th",{id:"id",children:e.text.id}),Object(u.jsx)("th",{id:"rentDate",children:e.text.rentDate}),Object(u.jsx)("th",{id:"returnDate",children:e.text.returnDate})]},"ID"),t&&t.map((function(e,t){return function(e,t){var n=e.id,c=e.rentDate,r=e.retDate,a=e.claim,s=e.user,i=e.userName,d=t.toString();return Object(u.jsxs)(o.a.Fragment,{children:[Object(u.jsxs)("tr",{className:"bookTop",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsx)(l.b,{to:"/search/"+n,children:n})}),Object(u.jsx)("td",{className:"bookCell",children:c}),Object(u.jsx)("td",{className:"bookCell",children:r})]},d),Object(u.jsxs)("tr",{className:"bookRow",children:[Object(u.jsx)("td",{className:"bookName",children:a}),Object(u.jsxs)("td",{colSpan:"2",className:"bookCell",children:[e.totalName+" ",Object(u.jsx)("b",{children:e.title})," "+e.claim_num]})]},d+"Title"),Object(u.jsxs)("tr",{className:"bookBottom",children:[Object(u.jsx)("td",{className:"bookCell",children:Object(u.jsxs)(l.b,{to:"/userSearch/"+s,children:[" ",s," "]})}),Object(u.jsxs)("td",{colSpan:"2",className:"bookCell",children:[" ",i," "]})]},d+"Renter")]},d+"Fragment")}(e,t)})),t&&0===t.length&&Object(u.jsx)("tr",{children:Object(u.jsx)("td",{colSpan:"3",children:e.text.noEntry})},"None")]})})})};function ue(e,t){switch(console.log(e),console.log(t),e){case 0:J(t);break;case 1:te(parseInt(t))}}return Object(c.useEffect)((function(){ae(Q.toString()+"-"+ee.toString().padStart(2,"0"))}),[Q,ee]),Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){var n,c,o,r,s,i,l,u,d,j,h,O;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Search"),!e.doc.serverAvailable){t.next=16;break}return n="https://"+e.doc.serverInfo.localIp+":"+e.doc.serverInfo.port+"/history",c={period:re},t.next=6,e.doc.requestGet(n,c);case 6:for(o=t.sent,console.log(o),r=o.data.return.books,s=[],i="",l=0;l<r.length;l++)u=r[l],d="".concat(u.BOOKNAME," ").concat(u.CLAIMNUM),"_RETURN_DATE"in u&&(i=u._RETURN_DATE),j={index:l,text:d,title:u.BOOKNAME,id:u.BARCODE,rentDate:u.RENT_DATE,retDate:i,author:u.AUTHOR,totalName:u.TOTAL_NAME,claim_num:u.CLAMENUM,publish:u.PUBLISH,claim:u.CLAIM,user:u.USER,userName:u.USER_NAME},s.push(j);s.sort(v),b(s),t.next=30;break;case 16:return O=ee+1,h=Q.toString()+"-"+O.toString().padStart(2,"0"),p(re),S(h),console.log(re),console.log(h),t.prev=22,t.next=25,U();case 25:t.next=30;break;case 27:t.prev=27,t.t0=t.catch(22),console.warn(t.t0.name);case 30:case"end":return t.stop()}}),t,null,[[22,27]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[ie]),e.doc.initialized?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.history})}),Object(u.jsxs)("div",{id:"searchRange",children:[Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(I.a,{fontSize:"large",sx:{color:"#404040"},onClick:function(){!function(){var e=Q,t=ee;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t>1?t-=1:(e-=1,t=12),J(e),te(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})}),Object(u.jsx)("select",{name:"year",id:"year",className:"dropdown",onChange:function(e){ue(0,e.target.value)}}),Object(u.jsx)("select",{name:"month",id:"month",className:"dropdown",onChange:function(e){ue(1,e.target.value)}}),Object(u.jsx)("div",{className:"page",id:"page",children:Object(u.jsx)(A.a,{fontSize:"large",sx:{color:"#404040"},onClick:function(){!function(){var e=Q,t=ee;"string"===typeof e&&(e=parseInt(e)),"string"===typeof t&&(t=parseInt(t)),console.log(e),console.log(t),console.log(typeof e),console.log(typeof t),t<12?t+=1:(e+=1,t=1),J(e),te(t),document.getElementById("year").value=e,document.getElementById("month").value=t}()}})})]}),Object(u.jsx)("div",{id:"checkOutResult",children:Object(u.jsx)(K,{keyValue:ie,list:d,showCallback:function(e){return le(e)}})})]}):Object(u.jsx)(y.a,{to:"/"})};var me=function(e){var t=Object(c.useState)({}),o=Object(i.a)(t,2),r=o[0],l=o[1],d=Object(c.useState)(!1),b=Object(i.a)(d,2),j=b[0],h=b[1];function O(){var e={USER_CODE:"",USER_NAME:"",PHONE_NUMBER:"",EMAIL:"",ADDRESS:"",NOTICE:"",USER_LEVEL:-1};l(e)}return Object(c.useEffect)((function(){function t(){return(t=Object(s.a)(Object(a.a)().mark((function t(){return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.doc.initialized&&e.doc.serverAvailable){t.next=2;break}return t.abrupt("return");case 2:n.e(0).then(n.t.bind(null,511,7)),console.log("======================================="),console.log("NewMember initialize"),O();case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),e.doc.initialized&&e.doc.serverAvailable?Object(u.jsxs)("div",{id:"checkOut",children:[Object(u.jsx)("div",{id:"title",children:Object(u.jsx)("h2",{children:e.text.newMember})}),Object(u.jsx)("div",{id:"checkOutInput",hidden:!e.doc.admin,children:e.doc.serverAvailable&&Object(u.jsx)(fe,{text:e.text,doc:e.doc,info:r,refresh:function(t){console.log("Refresh page "+j),console.log(t),h(!j);var n,c=f;"OK"===t.data.return?(c.type=se.c.TYPE.SUCCESS,n=e.text.regSuccess,O()):(c.type=se.c.TYPE.ERROR,n=e.text.regFail),c.autoClose=3e3,se.c.info(n,c)}})})]}):Object(u.jsx)(y.a,{to:"/"})},ve=(n(306),n(55)),ke=n(16),Se=n(15),Ee=n(505),ye=function(){function e(){Object(ke.a)(this,e),console.log("Create Doc class"),this.initialized=!1,this.bookReady=!1,this.rentReady=!1,this.userReady=!1,this.logged=!1,this.userInfo={},this.book={},this.rent={},this.request=new Set,this.logCallback=void 0,this.admin=!1,this.dueDate="",this.serverInfo={},this.serverAvailable=!1,this.ipAddr=""}return Object(Se.a)(e,[{key:"requestGet",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t,n){var c,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.os=navigator.platform,c={params:n},console.log("Request GET : "+t),e.next=5,Ee.a.get(t,c);case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"requestPost",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t,n){var c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Request POST: "+t),n.os=navigator.platform,e.next=4,Ee.a.post(t,n);case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateIpAddr",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"checkServerIp",value:function(){}},{key:"checkState",value:function(){this.bookReady&&this.rentReady&&(this.initialized=!0,se.c.dismiss(),this.callback&&this.callback())}},{key:"setLogCallback",value:function(e){this.logCallback=e}},{key:"setRent",value:function(e){this.rent=e,this.rentReady=!0,this.checkState(),this.checkRent()}},{key:"setRequest",value:function(e){var t,n=Object(ne.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value;this.request.add(c.book_id)}}catch(o){n.e(o)}finally{n.f()}}},{key:"hasRequest",value:function(e){return this.request.has(e)}},{key:"addRequest",value:function(e){this.request.add(e)}},{key:"setServerInfo",value:function(e){console.log(e),this.serverInfo=e,this.serverInfo={},this.serverInfo.globalIp=e.globalIp,e.proxy?(this.serverInfo.localIp="libserver.hkmcclibrary.duckdns.org",this.serverInfo.port=443):(this.serverInfo.localIp=e.localIp,this.serverInfo.port=e.port),console.log(this.serverInfo),this.checkServerIp()}},{key:"setBook",value:function(e){this.book={},console.log("Register "+e.length+" books");for(var t=0;t<e.length;t++){var n=e[t],c=n._id;this.book[c]=Object(ve.a)({},n),this.book[c].claim=n.claim.replace(/_/g," ")}this.bookReady=!0,this.checkState()}},{key:"setUser",value:function(e){this.user={};for(var t=0;t<e.length;t++){var n=e[t],c=n.id;this.user[c]=n,this.user[c].rent=0}this.userReady=!0,this.checkRent()}},{key:"checkRent",value:function(){if(this.userReady&&this.rentReady)for(var e=0;e<this.rent.length;e++){var t=this.rent[e].state;if("1"===t||"3"===t||1===t||3===t){var n=this.rent[e].user_id;n&&n.length>0&&n in this.user?"rent"in this.user[n]?this.user[n].rent+=1:this.user[n].rent=1:(console.log("Invalid user"),console.log(this.rent[e]))}}else console.log("Cannot check rent")}},{key:"logIn",value:function(e){console.log("Logged in: "+e._id),this.logged=!0,this.userInfo=e,"2"!==e.level&&2!==e.level||(this.admin=!0),this.logCallback&&this.logCallback(!0);var t=e._id;console.log(t)}},{key:"logOut",value:function(){console.log("Logged out"),this.logged=!1,this.admin=!1,this.userInfo={},this.request.clear(),this.logCallback&&this.logCallback(!1)}},{key:"getRent",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c,o,r,s,i,l,u,d,b,j,h,O,f=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:void 0,n=[],!this.serverAvailable){e.next=12;break}return c="https://"+this.serverInfo.localIp+":"+this.serverInfo.port+"/book",o={user:t},e.next=7,this.requestGet(c,o);case 7:if(r=e.sent,console.log(r),"books"in r.data.return){s=Object(ne.a)(r.data.return.books);try{for(s.s();!(i=s.n()).done;)l=i.value,console.log(l),u={id:l.BARCODE,title:l.BOOKNAME,claim:l.CLAIM,claim_num:l.CLAMENUM,totalName:l.TOTAL_NAME,rentDate:l.LENT_DATE,retDate:l.RETURN_DATE,stat:l.STATS,extendCount:l._EXTEND_COUNT},n.push(u)}catch(a){s.e(a)}finally{s.f()}}e.next=39;break;case 12:if(console.log("Check "+t),console.log(this.bookReady),this.bookReady){e.next=16;break}return e.abrupt("return",n);case 16:d=0;case 17:if(!(d<this.rent.length)){e.next=39;break}if(b=this.rent[d],void 0===t||b.user_id===t){e.next=21;break}return e.abrupt("continue",36);case 21:if("1"===b.state||"3"===b.state||1===b.state||3===b.state){e.next=23;break}return e.abrupt("continue",36);case 23:j=b.book_id,h=this.book[j],(O={}).id=h._id,O.title=h.title,O.claim_num=h.claim_num,O.totalName=h.series,O.rentDate=b.rent_date.split(" ")[0].replace("-","/",2).replace("-","/"),O.retDate=b.return_date.split(" ")[0].replace("-","/",2).replace("-","/"),O.claim=h.claim,O.user=b.user_id,O.extendCount=b.extend_count,n.push(O);case 36:d++,e.next=17;break;case 39:return e.abrupt("return",n);case 40:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){return this.user}},{key:"openDoc",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.initialized=!0,e.next=8;break;case 4:return e.prev=4,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"isOpen",value:function(){return this.initialized}},{key:"setCallback",value:function(e){console.log("Update function registered"),this.callback=e}}]),e}(),Ne=ye,Ie=n(504),Ce=n(497),Ae=n(498),_e=n(76),Re=n(310),we=_e.queue_url,De=function(){function e(t){Object(ke.a)(this,e),console.log("Create Context"),console.log("Cookies");var n=document.cookie;this.cookie=n.split(";").map((function(e){return e.split("=")})).reduce((function(e,t){var n=t.shift().trim(),c=t.join("=").trim();return e[decodeURIComponent(n)]=decodeURIComponent(c),e}),{});var c=t.REACT_APP_AWSS_KEY1+t.REACT_APP_AWSS_KEY2,o=t.REACT_APP_AWSS_SECRET1+t.REACT_APP_AWSS_SECRET2,r={region:_e.region,credentials:{accessKeyId:c,secretAccessKey:o}};this.sqsClient=new Ie.a(r),this.prk=new Re(t.REACT_APP_PRIVATE_KEY)}return Object(Se.a)(e,[{key:"checkLogIn",value:function(e,t){var n,c=!1;if(e&&t.length>0){console.log("User data available");var o=e.encrypted_email,r=e.encrypted_phone;if(n=this.prk.sign(t,"base64"),t===o||t===r)n=t,c=!0;else if(o===n)c=!0;else{for(var a="",s=0;s<t.length;s++)isNaN(t[s])||(a+=t[s]);(n=this.prk.sign(a,"base64"))===r&&(c=!0)}}if(c){var i=new Date;i.setTime(i.getTime()+1728e5);var l=i.toGMTString();document.cookie="password="+n+"; expires="+l+" ; SameSite=Lax ;"}return c}},{key:"sendRequest",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(t){var n,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.floor(1e8*Math.random()).toString(),e.prev=1,c=new Ce.a({MessageBody:t,QueueUrl:we,MessageGroupId:"1",MessageDeduplicationId:n}),e.next=5,this.sqsClient.send(c);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveRequest",value:function(){var e=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c,o,r,s,i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Read request"),t=[],e.prev=2,n=new Ae.a({QueueUrl:we,AttributeNames:[""],MessageAttributeNames:["STRING_VALUE"],MaxNumberOfMessages:100,VisibilityTimeout:5,WaitTimeSeconds:5}),e.next=6,this.sqsClient.send(n);case 6:if(c=e.sent,console.log(c),void 0!==c.Messages){o=Object(ne.a)(c.Messages);try{for(o.s();!(r=o.n()).done;)s=r.value,i=JSON.parse(s.Body),t.push(i)}catch(a){o.e(a)}finally{o.f()}}e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Te=De,Le=n(178),Ue=n(271),Be=(n(457),n(458),n(272)),Pe=n.n(Be);var Me=function(e){var t=Object(c.useState)(!1),o=Object(i.a)(t,2),r=o[0],a=o[1];Object(c.useEffect)((function(){e.doc.serverAvailable&&n.e(4).then(n.t.bind(null,512,7)),r&&setTimeout((function(){console.log("Register close"),window.addEventListener("click",s)}),100);var t=document.getElementById("dropdown-menu");return r?t.classList.add("is-show"):t.classList.remove("is-show"),function(){window.removeEventListener("click",s)}}),[r,e.doc.logged,e.doc.serverAvailable]);var s=function e(){console.log("Close"),console.log(r),a(!1),window.removeEventListener("click",e)};return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"menu",onClick:function(){console.log("Click menu"),a(!r),console.log(r),r&&window.removeEventListener("click",s)},children:Object(u.jsx)(Pe.a,{className:"img",fontSize:"large",sx:{color:"#ffffff"}})}),Object(u.jsxs)("div",{id:"dropdown-menu",onClick:function(){s()},className:"dropdown-menu",children:[!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"menu-items",children:e.doc.userInfo._id+" : "+e.doc.userInfo.name+e.text.nameSuffix}),Object(u.jsx)("hr",{className:"hline"})]}),Object(u.jsx)(l.b,{className:"menu-items",to:"/",children:e.text.home}),Object(u.jsx)(l.b,{className:"menu-items",to:"/notice",children:e.text.notice}),Object(u.jsx)(l.b,{className:"menu-items",to:"/search",children:e.text.bookSearch}),e.doc.serverAvailable&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(l.b,{className:"menu-items",to:"/checkOut",children:e.text.checkOut}),Object(u.jsx)(l.b,{className:"menu-items",to:"/return",children:e.text.return})]}),!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.checkOutStatus})}),e.doc.admin&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("hr",{className:"hline"}),Object(u.jsx)(l.b,{className:"menu-items",to:"/userSearch",children:e.text.userSearch}),Object(u.jsx)(l.b,{className:"menu-items",to:"/rentalSituation",children:e.text.situation}),Object(u.jsx)(l.b,{className:"menu-items",to:"/rentHistory",children:e.text.history})]}),e.doc.serverAvailable&&e.doc.admin&&Object(u.jsx)(l.b,{className:"menu-items",to:"/newMember",children:e.text.newMember}),!e.doc.serverAvailable&&e.doc.logged&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("hr",{className:"hline"}),Object(u.jsx)("div",{className:"menu-items",onClick:function(){e.doc.logOut(),document.cookie="user_id=",document.cookie="password=",document.cookie="autoLogin=false"},children:e.text.logOut})]}),!e.doc.serverAvailable&&!e.doc.logged&&Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(l.b,{className:"menu-items",to:"/checkOutStatus",children:e.text.logIn})})]})]})};var qe=function(e){return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{id:"navbar",className:"navbar",children:[Object(u.jsx)("div",{className:"title",children:Ue.isMobile?Object(u.jsx)("h1",{children:e.text.titleShort}):Object(u.jsx)("h1",{children:e.text.titleLong})}),Object(u.jsx)(Me,{text:e.text,doc:e.doc})]})})},He=new Ne,Ke=new Te(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_HASURA_TOKEN:"bkkZk6R6B9zITCmVyVDCtjDLWURfW4lC0ye04GP4UWN77ASpl69W6bk4BvyjN9ZH",REACT_APP_NAME:"library",REACT_APP_PRIVATE_KEY:"-----BEGIN RSA PRIVATE KEY-----\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\n-----END RSA PRIVATE KEY-----\n",REACT_APP_VERSION:"0.9.10"})),Ve={},ze="";var Ye=function(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)(!1),h=Object(i.a)(r,2),O=h[0],x=h[1],p=Object(c.useState)(""),g=Object(i.a)(p,2),m=g[0],v=g[1],k=Object(b.e)(Y),E=k.loading,N=k.error,I=k.data,C=Object(j.a)(ee,{variables:{user_id:m}}),A=Object(i.a)(C,2),_=A[0],R=A[1].data,w=Object(b.e)($),D=w.loading,T=w.error,L=w.data,U=Object(j.a)(W,{variables:{_id:m}}),B=Object(i.a)(U,2),P=B[0],M=B[1].data;function q(){var e=f;e.type=se.c.TYPE.SUCCESS,e.render=Ve.succeededToOpen,e.autoClose=3e3,e.toastId="",se.c.info(Ve.succeededToOpen,e)}function H(e){console.log("==== Update logging state "+He.logged),x(He.logged)}return Object(c.useEffect)((function(){function e(){return(e=Object(s.a)(Object(a.a)().mark((function e(){var t,n,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c in console.log("Initialize app"),console.log("Platform: "),console.log(navigator.platform),ze+="<p>Initialize app</p>",console.log("library"),console.log("0.9.10"),console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/library",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AWSS_KEY1:"AKIARJHWVM",REACT_APP_AWSS_KEY2:"Y4YGU3MDMX",REACT_APP_AWSS_SECRET1:"Xvk2fxmia49bRets3DvZ",REACT_APP_AWSS_SECRET2:"G0bqmrQvaiBofvpnfQ7Q",REACT_APP_HASURA_TOKEN:"bkkZk6R6B9zITCmVyVDCtjDLWURfW4lC0ye04GP4UWN77ASpl69W6bk4BvyjN9ZH",REACT_APP_NAME:"library",REACT_APP_PRIVATE_KEY:"-----BEGIN RSA PRIVATE KEY-----\nMIICYAIBAAKBgQCrjaN6qZ81C0wl1uegCHbI/psEvpTNzBCS42ZwvVDq2y69kXfx\nkDygmKqWi8rTFm6lx474GOAKpneEQ3ragP017HbW55hrXhQu2jK/UE5OPdIImPF5\nY2v28y0WEdWd0h6/4S28lSE5nG0IigsfuIh0FIvH9vGVwBqCPm1DOEAUIQIDAQAB\nAoGAE/ZVUY6vUfLQl46cQUj62YSW8URj+FaIjy8a2n+NDOcYV0K4HEnWZDGfmAkI\nPuvbUDsabdAnMdYRDjjz1H7L4Y52vU+ZqD3+kJ3iUsR9Ba+R17zS6F4HVNPCzUDI\nOpgE+z8od8+on2cppBPHMEl/Ze+CcKYLz7bLs8zje8QHZMkCRQDyuEx9WQSCf0LS\nds+jwr7npwVlbb737oal6UKuVzKv039aLaxBpsAeMQsSdXgBq2E2ChmC8SmPuB0V\n0mutfSBu2UapkwI9ALTwh/iFkje7O/1wjCVZn4TnLz6a4nx676rydpsRy2PrDyQ3\naC5SWmzQezeSTs9Qmbhxm4ZTj3Co4aeL+wJEC+zqNS5ufkrqaZTU1uL2pkMajMU7\noMrjartvP0mhf+oQU8nysLcUsWcPeDS1VL+q4xDT+A8JT7poE25nQ/rl4Qxj4GkC\nPQCR+zoIlWOZ2VMWMBayD7P22zqvzPCMM/dnuYVdqSaqr7wgoR9JuCHChxXSiRVS\niBntyKMM5h/laivdLL8CRGdrBwiAkVrYnghDj+9UJX9Twox3oahPqYhzxWJR7jZ4\nipOKhw9r+YfZDNDYpVgE+g2KB75tZlOU9Hx7dXyzANnsIueT\n-----END RSA PRIVATE KEY-----\n",REACT_APP_VERSION:"0.9.10"}).REACT_APP_QUEUE_URL),t=navigator.languages,console.log(t),n={},n=t.length>0&&(t[0].toLowerCase().includes("kr")||t[0].toLowerCase().includes("ko"))?Le.kr:Le.en)Ve[c]=n[c];return e.next=14,He.updateIpAddr();case 14:"autoLogin"in Ke.cookie&&"true"===Ke.cookie.autoLogin&&(console.log("Auto Login: "+Ke.cookie.user_id),v(Ke.cookie.user_id),console.log(Ke.cookie.nothing),P()),o(!0);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[P]),Object(c.useEffect)((function(){if(console.log("User data loaded"),M){var e=M.user[0];Ke.cookie.password&&Ke.checkLogIn(e,Ke.cookie.password)&&(console.log("Login suceeded"),He.logIn(e),_())}}),[M]),Object(c.useEffect)((function(){console.log("Rent Query Updated"),ze=ze+"<p>Rent Query Updated "+E+" "+N+"</p>",console.log(E),console.log("Rent Error"),console.log(N),I&&(console.log("Rent available"),ze+="<p>Rent available</p>",He.setRent(I.rent),He.initialized&&q())}),[E,N,I]),Object(c.useEffect)((function(){console.log("Request Query Updated"),R&&(console.log("Request available"),He.setRequest(R.request))}),[R]),Object(c.useEffect)((function(){if(console.log("Server Query Updated"),ze+="<p>Server Query Updated</p>",console.log(L),console.log(n),L&&n&&(console.log("Server info available"),ze+="<p>Server info available</p>",console.log(L),He.setServerInfo(L.serverInfo),!He.serverAvailable)){console.log("Server is not available. Load books from cloud DB");var e=f;e.type=se.c.TYPE.LOADING,e.autoClose=!1,e.toastId=S,se.c.loading(Ve.loading,e),He.setLogCallback(H),console.log("Get github file"),He.requestGet(_e.book_url,{}).then((function(e){var t=e.data;console.log("Downloaded books");var n=[];for(var c in t){var o=t[c];n.push(o)}He.setBook(n),He.initialized&&q()}))}}),[D,T,L,n]),Object(u.jsx)(l.a,{children:Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)("div",{children:Object(u.jsx)(se.a,{newestOnTop:!0,closeOnClick:!0,rtl:!1,draggable:!0,pauseOnHover:!0,pauseOnFocusLoss:!1,transition:se.b,limit:10})}),Object(u.jsx)(qe,{doc:He,text:Ve}),Object(u.jsxs)(y.d,{children:[Object(u.jsx)(y.b,{path:"/",element:Object(u.jsx)(d,{doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/notice/:id?",element:Object(u.jsx)(te,{doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/search/:id?",element:Object(u.jsx)(ae,{doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/checkOutStatus",element:Object(u.jsx)(ue,{context:Ke,doc:He,text:Ve,logged:O})}),Object(u.jsx)(y.b,{path:"/userSearch/:id?",element:Object(u.jsx)(xe,{context:Ke,doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/checkOut/:id?",element:Object(u.jsx)(be,{context:Ke,doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/return",element:Object(u.jsx)(Oe,{context:Ke,doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/rentalSituation",element:Object(u.jsx)(pe,{context:Ke,doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/rentHistory",element:Object(u.jsx)(ge,{context:Ke,doc:He,text:Ve})}),Object(u.jsx)(y.b,{path:"/newMember",element:Object(u.jsx)(me,{context:Ke,doc:He,text:Ve})})]}),Object(u.jsxs)("h3",{children:["v ","0.9.10"]})]})})},Fe=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,513)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),c(e),o(e),r(e),a(e)}))},We=n(507),Ge=n(506),Qe=n(508),Ze=n(503),Je=new We.a({link:new Ge.a({uri:_e.graphql_url,headers:{"x-hasura-admin-secret":"bkkZk6R6B9zITCmVyVDCtjDLWURfW4lC0ye04GP4UWN77ASpl69W6bk4BvyjN9ZH"}}),cache:new Qe.a}),Xe=document.getElementById("root");Object(r.createRoot)(Xe).render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(Ze.a,{client:Je,children:Object(u.jsx)(Ye,{})})})),Fe()},56:function(e,t,n){},76:function(e){e.exports=JSON.parse('{"book_url":"https://raw.githubusercontent.com/linupa/hkmccBook/main/book.json","graphql_url":"https://hkmcc-library.hasura.app/v1/graphql","queue_url":"https://sqs.us-west-1.amazonaws.com/088564131385/HKMCCLibraryRequest.fifo","region":"us-west-1"}')}},[[460,2,3]]]);
//# sourceMappingURL=main.491902c2.chunk.js.map